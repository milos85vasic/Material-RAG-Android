








<!doctype html>
<html 
      lang="en"
      dir="ltr">
  <head>
    <meta name="google-signin-client-id" content="721724668570-nbkv1cfusk7kk4eni4pjvepaus73b13t.apps.googleusercontent.com">
    <meta name="google-signin-scope"
          content="profile email https://www.googleapis.com/auth/developerprofiles https://www.googleapis.com/auth/developerprofiles.award">
    <meta property="og:site_name" content="Android Developers">
    <meta property="og:type" content="website"><meta name="theme-color" content="#34a853"><meta charset="utf-8">
    <meta content="IE=Edge" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    

    <link rel="manifest" href="/_pwa/android/manifest.json"
          crossorigin="use-credentials">
    <link rel="preconnect" href="//www.gstatic.com" crossorigin>
    <link rel="preconnect" href="//fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="//fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="//apis.google.com" crossorigin>
    <link rel="preconnect" href="//www.google-analytics.com" crossorigin><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Google+Sans:400,500,600,700|Google+Sans+Text:400,400italic,500,500italic,600,600italic,700,700italic|Roboto+Mono:400,500,700&display=swap">
      <link rel="stylesheet"
            href="//fonts.googleapis.com/css2?family=Material+Icons&family=Material+Symbols+Outlined&display=block"><link rel="stylesheet" href="https://www.gstatic.com/devrel-devsite/prod/vc12d84b6edb3e25e1619b575cf813e1849a1c95098b711a6c56ab3968c9a4fa9/android/css/app.css">
      
        <link rel="stylesheet" href="https://www.gstatic.com/devrel-devsite/prod/vc12d84b6edb3e25e1619b575cf813e1849a1c95098b711a6c56ab3968c9a4fa9/android/css/dark-theme.css" disabled>
      <link rel="shortcut icon" href="https://www.gstatic.com/devrel-devsite/prod/vc12d84b6edb3e25e1619b575cf813e1849a1c95098b711a6c56ab3968c9a4fa9/android/images/favicon.svg">
    <link rel="apple-touch-icon" href="https://www.gstatic.com/devrel-devsite/prod/vc12d84b6edb3e25e1619b575cf813e1849a1c95098b711a6c56ab3968c9a4fa9/android/images/touchicon-180.png"><link rel="canonical" href="https://developer.android.com/codelabs/android-direct-share"><link rel="search" type="application/opensearchdescription+xml"
            title="Android Developers" href="https://developer.android.com/s/opensearch.xml">
      <link rel="alternate" hreflang="en"
          href="https://developer.android.com/codelabs/android-direct-share" /><link rel="alternate" hreflang="x-default" href="https://developer.android.com/codelabs/android-direct-share" /><title>(Deprecated) Direct Share to an Android app &nbsp;|&nbsp; Android Developers</title>

<meta property="og:title" content="(Deprecated) Direct Share to an Android app &nbsp;|&nbsp; Android Developers"><meta name="description" content="Direct Share makes sharing content quicker and easier. In this codelab, you’ll build an app that is able to display a list of contacts in the system Intent chooser dialog so you can jump directly into the app to make the sharing process seamless.">
  <meta property="og:description" content="Direct Share makes sharing content quicker and easier. In this codelab, you’ll build an app that is able to display a list of contacts in the system Intent chooser dialog so you can jump directly into the app to make the sharing process seamless."><meta property="og:url" content="https://developer.android.com/codelabs/android-direct-share"><meta property="og:locale" content="en">
  
    
    
    
    
    
    
    
    
  

    
      <link rel="stylesheet" href="/extras.css"></head>
  <body class=""
        template="codelab"
        theme="android-theme"
        type="codelab"
        
        
        appearance
        
        layout="docs"
        
        
        
        
        display-toc
        pending>
  
    <devsite-progress type="indeterminate" id="app-progress"></devsite-progress>
  
  
    <a href="#main-content" class="skip-link button">
      
      Skip to main content
    </a>
    <section class="devsite-wrapper">
      <devsite-cookie-notification-bar></devsite-cookie-notification-bar><devsite-header role="banner">
  
    





















<div class="devsite-header--inner" data-nosnippet>
  <div class="devsite-top-logo-row-wrapper-wrapper">
    <div class="devsite-top-logo-row-wrapper">
      <div class="devsite-top-logo-row">
        <button type="button" id="devsite-hamburger-menu"
          class="devsite-header-icon-button button-flat material-icons gc-analytics-event"
          data-category="Site-Wide Custom Events"
          data-label="Navigation menu button"
          visually-hidden
          aria-label="Open menu">
        </button>
        
<div class="devsite-product-name-wrapper">

  <a href="/" class="devsite-site-logo-link gc-analytics-event"
   data-category="Site-Wide Custom Events" data-label="Site logo" track-type="globalNav"
   track-name="androidDevelopers" track-metadata-position="nav"
   track-metadata-eventDetail="nav">
  
  <picture>
    
    <source srcset="https://www.gstatic.com/devrel-devsite/prod/vc12d84b6edb3e25e1619b575cf813e1849a1c95098b711a6c56ab3968c9a4fa9/android/images/lockup-dark-theme.png"
            media="(prefers-color-scheme: dark)"
            class="devsite-dark-theme">
    
    <img src="https://www.gstatic.com/devrel-devsite/prod/vc12d84b6edb3e25e1619b575cf813e1849a1c95098b711a6c56ab3968c9a4fa9/android/images/lockup.png" class="devsite-site-logo" alt="Android Developers">
  </picture>
  
</a>



</div>
        <div class="devsite-top-logo-row-middle">
          <div class="devsite-header-upper-tabs">
            
           </div>
          
<devsite-search
    enable-signin
    enable-search
    enable-suggestions
      enable-query-completion
    
    enable-search-summaries
    
    tenant-name="Android Developers"
    
    
    
    
    
    >
  <form class="devsite-search-form" action="https://developer.android.com/s/results" method="GET">
    <div class="devsite-search-container">
      <button type="button"
              search-open
              class="devsite-search-button devsite-header-icon-button button-flat material-icons"
              
              aria-label="Open search"></button>
      <div class="devsite-searchbox">
        <input
          aria-activedescendant=""
          aria-autocomplete="list"
          
          aria-label="Search"
          aria-expanded="false"
          aria-haspopup="listbox"
          autocomplete="off"
          class="devsite-search-field devsite-search-query"
          name="q"
          
          placeholder="Search"
          role="combobox"
          type="text"
          value=""
          >
          <div class="devsite-search-image material-icons" aria-hidden="true">
            
              <svg class="devsite-search-ai-image" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <g clip-path="url(#clip0_6641_386)">
                    <path d="M19.6 21L13.3 14.7C12.8 15.1 12.225 15.4167 11.575 15.65C10.925 15.8833 10.2333 16 9.5 16C7.68333 16 6.14167 15.375 4.875 14.125C3.625 12.8583 3 11.3167 3 9.5C3 7.68333 3.625 6.15 4.875 4.9C6.14167 3.63333 7.68333 3 9.5 3C10.0167 3 10.5167 3.05833 11 3.175C11.4833 3.275 11.9417 3.43333 12.375 3.65L10.825 5.2C10.6083 5.13333 10.3917 5.08333 10.175 5.05C9.95833 5.01667 9.73333 5 9.5 5C8.25 5 7.18333 5.44167 6.3 6.325C5.43333 7.19167 5 8.25 5 9.5C5 10.75 5.43333 11.8167 6.3 12.7C7.18333 13.5667 8.25 14 9.5 14C10.6667 14 11.6667 13.625 12.5 12.875C13.35 12.1083 13.8417 11.15 13.975 10H15.975C15.925 10.6333 15.7833 11.2333 15.55 11.8C15.3333 12.3667 15.05 12.8667 14.7 13.3L21 19.6L19.6 21ZM17.5 12C17.5 10.4667 16.9667 9.16667 15.9 8.1C14.8333 7.03333 13.5333 6.5 12 6.5C13.5333 6.5 14.8333 5.96667 15.9 4.9C16.9667 3.83333 17.5 2.53333 17.5 0.999999C17.5 2.53333 18.0333 3.83333 19.1 4.9C20.1667 5.96667 21.4667 6.5 23 6.5C21.4667 6.5 20.1667 7.03333 19.1 8.1C18.0333 9.16667 17.5 10.4667 17.5 12Z" fill="#5F6368"/>
                  </g>
                <defs>
                <clipPath id="clip0_6641_386">
                <rect width="24" height="24" fill="white"/>
                </clipPath>
                </defs>
              </svg>
            
          </div>
          <div class="devsite-search-shortcut-icon-container" aria-hidden="true">
            <kbd class="devsite-search-shortcut-icon">/</kbd>
          </div>
      </div>
    </div>
  </form>
  <button type="button"
          search-close
          class="devsite-search-button devsite-header-icon-button button-flat material-icons"
          
          aria-label="Close search"></button>
</devsite-search>

        </div>

        

          

          

          <devsite-appearance-selector></devsite-appearance-selector>

          
<devsite-language-selector>
  <ul role="presentation">
    
    
    <li role="presentation">
      <a role="menuitem" lang="en"
        >English</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="de"
        >Deutsch</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="es_419"
        >Español – América Latina</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="fr"
        >Français</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="id"
        >Indonesia</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="pl"
        >Polski</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="pt_br"
        >Português – Brasil</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="vi"
        >Tiếng Việt</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="zh_cn"
        >中文 – 简体</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="ja"
        >日本語</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="ko"
        >한국어</a>
    </li>
    
  </ul>
</devsite-language-selector>


          
            <a class="devsite-header-link devsite-top-button button gc-analytics-event "
    href="https://developer.android.com/studio"
    data-category="Site-Wide Custom Events"
    data-label="Site header link: Android Studio"
    >
  Android Studio
</a>
          

        

        
          <devsite-user 
                        
                        
                          enable-profiles
                        
                        
                        id="devsite-user">
            
              
              <span class="button devsite-top-button" aria-hidden="true" visually-hidden>Sign in</span>
            
          </devsite-user>
        
        
        
      </div>
    </div>
  </div>



</div>



  
</devsite-header>
      <devsite-book-nav scrollbars hidden>
        
          





















<div class="devsite-book-nav-filter"
     hidden>
  <span class="filter-list-icon material-icons" aria-hidden="true"></span>
  <input type="text"
         placeholder="Filter"
         
         aria-label="Type to filter"
         role="searchbox">
  
  <span class="filter-clear-button hidden"
        data-title="Clear filter"
        aria-label="Clear filter"
        role="button"
        tabindex="0"></span>
</div>

<nav class="devsite-book-nav devsite-nav nocontent"
     aria-label="Side menu">
  <div class="devsite-mobile-header">
    <button type="button"
            id="devsite-close-nav"
            class="devsite-header-icon-button button-flat material-icons gc-analytics-event"
            data-category="Site-Wide Custom Events"
            data-label="Close navigation"
            aria-label="Close navigation">
    </button>
    <div class="devsite-product-name-wrapper">

  <a href="/" class="devsite-site-logo-link gc-analytics-event"
   data-category="Site-Wide Custom Events" data-label="Site logo" track-type="globalNav"
   track-name="androidDevelopers" track-metadata-position="nav"
   track-metadata-eventDetail="nav">
  
  <picture>
    
    <source srcset="https://www.gstatic.com/devrel-devsite/prod/vc12d84b6edb3e25e1619b575cf813e1849a1c95098b711a6c56ab3968c9a4fa9/android/images/lockup-dark-theme.png"
            media="(prefers-color-scheme: dark)"
            class="devsite-dark-theme">
    
    <img src="https://www.gstatic.com/devrel-devsite/prod/vc12d84b6edb3e25e1619b575cf813e1849a1c95098b711a6c56ab3968c9a4fa9/android/images/lockup.png" class="devsite-site-logo" alt="Android Developers">
  </picture>
  
</a>


</div>
  </div>

  <div class="devsite-book-nav-wrapper">
    <div class="devsite-mobile-nav-top">
      
        <ul class="devsite-nav-list">
          
          
    
    
<li class="devsite-nav-item">

  
  <a href="/studio"
    
       class="devsite-nav-title gc-analytics-event "
    

    
     data-category="Site-Wide Custom Events"
     data-label="Responsive Tab: Android Studio"
     track-type="navMenu"
     track-metadata-eventDetail="globalMenu"
     track-metadata-position="nav">
  
    <span class="devsite-nav-text" tooltip >
      Android Studio
   </span>
    
  
  </a>
  

</li>

  
          
        </ul>
      
    </div>
    
  </div>
</nav>
        
      </devsite-book-nav>
      <section id="gc-wrapper">
        <main role="main" id="main-content" class="devsite-main-content"
            
              
              has-sidebar
            >
          <div class="devsite-sidebar">
            <div class="devsite-sidebar-content">
                
                <devsite-toc class="devsite-nav"
                            role="navigation"
                            aria-label="On this page"
                            depth="1"
                            scrollbars
                  ></devsite-toc>
                <devsite-recommendations-sidebar class="nocontent devsite-nav">
                </devsite-recommendations-sidebar>
            </div>
          </div>
          <devsite-content>
            
              












<article class="devsite-article"><style>
      body {
        transition: opacity ease-in 0.2s;
      }

      body[unresolved] {
        opacity: 0;
        display: block;
        overflow: hidden;
        position: relative;
      }
      </style>
  
  
  
  
  

  <div class="devsite-article-meta nocontent" role="navigation">
    
    
    <ul class="devsite-breadcrumb-list"
  >
  
</ul>
    
  </div>
  
    <h1 class="devsite-page-title" tabindex="-1">
      (Deprecated) Direct Share to an Android app<div class="devsite-actions" hidden data-nosnippet><devsite-feature-tooltip
      ack-key="AckCollectionsBookmarkTooltipDismiss"
      analytics-category="Site-Wide Custom Events"
      analytics-action-show="Callout Profile displayed"
      analytics-action-close="Callout Profile dismissed"
      analytics-label="Create Collection Callout"
      class="devsite-page-bookmark-tooltip nocontent"
      dismiss-button="true"
      id="devsite-collections-dropdown"
      
      dismiss-button-text="Dismiss"

      
      close-button-text="Got it">

    
    
      <devsite-bookmark></devsite-bookmark>
    

    <span slot="popout-heading">
      
      Stay organized with collections
    </span>
    <span slot="popout-contents">
      
      Save and categorize content based on your preferences.
    </span>
  </devsite-feature-tooltip></div>
  
      
    </h1>
  

  <devsite-toc class="devsite-nav"
    depth="1"
    devsite-toc-embedded
    >
  </devsite-toc>
  
    
  <div class="devsite-article-body clearfix
  ">

  
    
    
    <google-codelab-analytics gaid="UA-49880327-14" ga4id="G-JTFZSJVVVZ"></google-codelab-analytics>
    <google-codelab codelab-gaid=""
                    codelab-ga4id=""
                    doc-id=""
                    id="android-direct-share"
                    title="(Deprecated) Direct Share to an Android app"
                    no-tooltip=""
                    environment="web"
                    category=""
                    feedback-link="https://github.com/android/codelab-android-direct-share/issues"
                    layout="paginated"
                    >
      
        <google-codelab-step label="Introduction" duration="2" step="0">
          
            <google-codelab-about codelab-title="(Deprecated) Direct Share to an Android app"
                                  
                                  last-updated="2024-12-11T15:47:48Z"
                                  duration="47">
            </google-codelab-about>
          
          <h2 class="step-title" id="0" data-text="Introduction" tabindex="-1">
              1. Introduction
          </h2>
          <aside class="warning"><p> This codelab is deprecated and will be removed soon.</p>
</aside>
<p>Direct Share is a feature that allows apps to show app-specific options directly in the system Intent chooser dialog. Users can then jump directly into your app when sharing content from another app. For example, a messaging app using Direct Share could enable the user to share content direct to a contact, which appears in the chooser dialog. Direct Share makes sharing content quicker and easier.</p>
<p class="image-container"><img alt="4272b0cacbab9093.png" style="width: 338.59px" src="/static/codelabs/android-direct-share/img/4272b0cacbab9093.png" srcset="https://developer.android.com/static/codelabs/android-direct-share/img/4272b0cacbab9093_36.png 36w,https://developer.android.com/static/codelabs/android-direct-share/img/4272b0cacbab9093_48.png 48w,https://developer.android.com/static/codelabs/android-direct-share/img/4272b0cacbab9093_72.png 72w,https://developer.android.com/static/codelabs/android-direct-share/img/4272b0cacbab9093_96.png 96w,https://developer.android.com/static/codelabs/android-direct-share/img/4272b0cacbab9093_480.png 480w,https://developer.android.com/static/codelabs/android-direct-share/img/4272b0cacbab9093_720.png 720w,https://developer.android.com/static/codelabs/android-direct-share/img/4272b0cacbab9093_856.png 856w,https://developer.android.com/static/codelabs/android-direct-share/img/4272b0cacbab9093_960.png 960w,https://developer.android.com/static/codelabs/android-direct-share/img/4272b0cacbab9093_1440.png 1440w,https://developer.android.com/static/codelabs/android-direct-share/img/4272b0cacbab9093_1920.png 1920w,https://developer.android.com/static/codelabs/android-direct-share/img/4272b0cacbab9093_2880.png 2880w" sizes="(max-width: 840px) 100vw, 856px"></p>
<p>In the image, you can see how the user can quickly select Tereasa or Chang to share the text &#34;Hello!&#34; directly to an app using Direct Share, without having to browse through the list of contacts.</p>
<p>Direct Share works with the concept of Sharing Shortcuts. The app can publish sharing targets in advance, allowing the system Intent chooser dialog to show them when required. To publish share targets, we will use the  <a href="https://developer.android.com/reference/androidx/core/content/pm/ShortcutManagerCompat.html" target="_blank">ShortcutManager API</a>. Any published sharing shortcuts are persisted by the system until the app updates them, or the app is uninstalled.</p>
<p>When shown to the user, the system ranks any applicable shortcuts using a prediction service, which shows shortcuts which are more likely to be used.</p>
<p>This codelab will walk you through implementing Direct Share in your app, including making it backwards compatible with older Android versions.</p>
<h2 is-upgraded id="what-you-will-build" data-text="What you will build" tabindex="-1">What you will build</h2>
<p>In this codelab, you will work with a messaging app that can receive Intents which contain plain text. When a user shares some text from some other app (or the one we&#39;re building), this app will be listed as an option. By using the Direct Share feature, this app also publishes some contacts shown in the system Intent chooser dialog.</p>
<p>You can see the sample app below:</p>
<p class="image-container"><img alt="1a2f836312a50861.gif" style="width: 340.41px" src="/static/codelabs/android-direct-share/img/1a2f836312a50861.gif"></p>
<p>All classes and functionality have already been created for you. You will implement Direct Share specific logic to:</p>
<ul>
<li>Publish sharing shortcuts with a specific category</li>
<li>Make Direct Share backwards compatible with older Android versions</li>
<li>Add a title and thumbnail to the content preview</li>
</ul>
<h2 is-upgraded id="what-you-will-learn" data-text="What you will learn" tabindex="-1">What you will learn</h2>
<ul>
<li>How to implement Direct Share in your app</li>
<li>How to make Direct Share backwards compatible with older Android versions</li>
<li>How to show content preview in shared content</li>
</ul>
<h2 is-upgraded id="prerequisites" data-text="Prerequisites" tabindex="-1">Prerequisites</h2>
<ul>
<li>Basic Kotlin knowledge (this codelab is in Kotlin)</li>
<li>Android Studio 3.3 or higher</li>
<li>Emulator or device running API 21+</li>
</ul>
<p>If you run into any issues (code bugs, grammatical errors, unclear wording, etc.) as you work through this codelab, please report the issue via the <strong>Report a mistake</strong> link in the lower left corner of the codelab.</p>


        </google-codelab-step>
      
        <google-codelab-step label="Getting Started" duration="5" step="1">
          
          <h2 class="step-title" id="1" data-text="Getting Started" tabindex="-1">
              2. Getting Started
          </h2>
          <h2 is-upgraded id="get-the-code" data-text="Get the Code" tabindex="-1">Get the Code</h2>
<p>Get the Direct Share codelab from GitHub:</p>
<div></div><devsite-code><pre translate="no" dir="ltr" is-upgraded>$ git clone https://github.com/android/codelab-android-direct-share
</pre></devsite-code>
<p>Alternatively you can download the repository as a Zip file:</p>
<p><a href="https://github.com/android/codelab-android-direct-share/archive/master.zip" target="_blank"><button class="button button-primary button-with-icon"><span class="material-icons" aria-hidden="true" translate="no">file_download</span>Download Zip</button></a></p>
<h2 is-upgraded id="get-android-studio-3.3-or-higher" data-text="Get Android Studio 3.3 or higher" tabindex="-1">Get Android Studio 3.3 or higher</h2>
<p>Make sure you are using Android Studio 3.3 or higher.</p>
<p>If you need to download a recent version of Android Studio, you can do so  <a href="https://developer.android.com/studio/" target="_blank">here</a>.</p>
<h2 is-upgraded id="project-set-up" data-text="Project set up" tabindex="-1">Project set up</h2>
<p>The preferred way to implement the Direct Share feature is using the Android Q API&#39;s capabilities. This is why your <code translate="no" dir="ltr">compileSdkVersion</code> needs to be at least &#34;29&#34;.</p>
<p>To follow the codelab, open the root folder with Android Studio. It will contain two sub-projects inside it:</p>
<ul>
<li><code translate="no" dir="ltr">direct-share-start</code> codelab&#39;s starting point.</li>
<li><code translate="no" dir="ltr">direct-share-done</code> solution to the codelab.</li>
</ul>
<aside class="special"><p><strong>Note:</strong> In <code translate="no" dir="ltr">direct-share-start</code> the code for each step in this codelab is included,  commented out between TODO statements.</p>
<p>To uncomment the code, you can use Android Studio shortcuts: ⌘ + <code translate="no" dir="ltr">/</code> in Mac or <code translate="no" dir="ltr">Ctrl</code> + <code translate="no" dir="ltr">/</code> in Windows/Linux.</p>
<p>You should compare the code you write to the included commented-out code.</p>
</aside>


        </google-codelab-step>
      
        <google-codelab-step label="Overview of the sample app" duration="0" step="2">
          
          <h2 class="step-title" id="2" data-text="Overview of the sample app" tabindex="-1">
              3. Overview of the sample app
          </h2>
          <p>This messaging app is able to:</p>
<ul>
<li>Share plain text via  <a href="https://developer.android.com/reference/android/content/Intent#ACTION_SEND" target="_blank">ACTION_SEND</a> Intents</li>
<li>Listen for plain text Intents to send messages to contacts</li>
<li>If there&#39;s no contact selected, the user can select a contact</li>
</ul>
<h2 is-upgraded id="running-the-sample-app" data-text="Running the sample app" tabindex="-1">Running the sample app</h2>
<aside class="warning"><p>Disclaimer: There are some issues with Direct Share when running in an emulator using Android 10. Running on a real device or an emulator with Android Q works fine.</p>
</aside>
<p>If you run <code translate="no" dir="ltr">direct-share-start-app</code>, the <strong>Share screen</strong> (<code translate="no" dir="ltr">MainActivity.kt</code>) will launch: Type anything you want on the EditText and click Share to share that text to any app.</p>
<p class="image-container"><img alt="a591d10e2db09026.png" style="width: 269.73px" src="/static/codelabs/android-direct-share/img/a591d10e2db09026.png" srcset="https://developer.android.com/static/codelabs/android-direct-share/img/a591d10e2db09026_36.png 36w,https://developer.android.com/static/codelabs/android-direct-share/img/a591d10e2db09026_48.png 48w,https://developer.android.com/static/codelabs/android-direct-share/img/a591d10e2db09026_72.png 72w,https://developer.android.com/static/codelabs/android-direct-share/img/a591d10e2db09026_96.png 96w,https://developer.android.com/static/codelabs/android-direct-share/img/a591d10e2db09026_480.png 480w,https://developer.android.com/static/codelabs/android-direct-share/img/a591d10e2db09026_720.png 720w,https://developer.android.com/static/codelabs/android-direct-share/img/a591d10e2db09026_856.png 856w,https://developer.android.com/static/codelabs/android-direct-share/img/a591d10e2db09026_960.png 960w,https://developer.android.com/static/codelabs/android-direct-share/img/a591d10e2db09026_1440.png 1440w,https://developer.android.com/static/codelabs/android-direct-share/img/a591d10e2db09026_1920.png 1920w,https://developer.android.com/static/codelabs/android-direct-share/img/a591d10e2db09026_2880.png 2880w" sizes="(max-width: 840px) 100vw, 856px"></p>
<p>Tapping on Share will trigger an Intent to the system and a system Intent dialog chooser will appear.</p>
<p class="image-container"><img alt="f8f107984daca635.png" style="width: 255.54px" src="/static/codelabs/android-direct-share/img/f8f107984daca635.png" srcset="https://developer.android.com/static/codelabs/android-direct-share/img/f8f107984daca635_36.png 36w,https://developer.android.com/static/codelabs/android-direct-share/img/f8f107984daca635_48.png 48w,https://developer.android.com/static/codelabs/android-direct-share/img/f8f107984daca635_72.png 72w,https://developer.android.com/static/codelabs/android-direct-share/img/f8f107984daca635_96.png 96w,https://developer.android.com/static/codelabs/android-direct-share/img/f8f107984daca635_480.png 480w,https://developer.android.com/static/codelabs/android-direct-share/img/f8f107984daca635_720.png 720w,https://developer.android.com/static/codelabs/android-direct-share/img/f8f107984daca635_856.png 856w,https://developer.android.com/static/codelabs/android-direct-share/img/f8f107984daca635_960.png 960w,https://developer.android.com/static/codelabs/android-direct-share/img/f8f107984daca635_1440.png 1440w,https://developer.android.com/static/codelabs/android-direct-share/img/f8f107984daca635_1920.png 1920w,https://developer.android.com/static/codelabs/android-direct-share/img/f8f107984daca635_2880.png 2880w" sizes="(max-width: 840px) 100vw, 856px"></p>
<p><strong>Select contact screen</strong> (<code translate="no" dir="ltr">SelectContactActivity.kt</code>): When the user selects the &#34;Direct Share&#34; messaging app to process the shared text, the user can choose who to share the message with. Notice that the user has to select the app, not a specific contact.</p>
<p class="image-container"><img alt="1b36a20eb107b020.png" style="width: 266.29px" src="/static/codelabs/android-direct-share/img/1b36a20eb107b020.png" srcset="https://developer.android.com/static/codelabs/android-direct-share/img/1b36a20eb107b020_36.png 36w,https://developer.android.com/static/codelabs/android-direct-share/img/1b36a20eb107b020_48.png 48w,https://developer.android.com/static/codelabs/android-direct-share/img/1b36a20eb107b020_72.png 72w,https://developer.android.com/static/codelabs/android-direct-share/img/1b36a20eb107b020_96.png 96w,https://developer.android.com/static/codelabs/android-direct-share/img/1b36a20eb107b020_480.png 480w,https://developer.android.com/static/codelabs/android-direct-share/img/1b36a20eb107b020_720.png 720w,https://developer.android.com/static/codelabs/android-direct-share/img/1b36a20eb107b020_856.png 856w,https://developer.android.com/static/codelabs/android-direct-share/img/1b36a20eb107b020_960.png 960w,https://developer.android.com/static/codelabs/android-direct-share/img/1b36a20eb107b020_1440.png 1440w,https://developer.android.com/static/codelabs/android-direct-share/img/1b36a20eb107b020_1920.png 1920w,https://developer.android.com/static/codelabs/android-direct-share/img/1b36a20eb107b020_2880.png 2880w" sizes="(max-width: 840px) 100vw, 856px"></p>
<p><strong>Send message screen</strong> (<code translate="no" dir="ltr">SendMessageActivity.kt</code>): Click send to send a message to a contact. The app will display a Toast as a signal that the message was sent.</p>
<p class="image-container"><img alt="14e2b1d9aa12bbb1.png" style="width: 271.57px" src="/static/codelabs/android-direct-share/img/14e2b1d9aa12bbb1.png" srcset="https://developer.android.com/static/codelabs/android-direct-share/img/14e2b1d9aa12bbb1_36.png 36w,https://developer.android.com/static/codelabs/android-direct-share/img/14e2b1d9aa12bbb1_48.png 48w,https://developer.android.com/static/codelabs/android-direct-share/img/14e2b1d9aa12bbb1_72.png 72w,https://developer.android.com/static/codelabs/android-direct-share/img/14e2b1d9aa12bbb1_96.png 96w,https://developer.android.com/static/codelabs/android-direct-share/img/14e2b1d9aa12bbb1_480.png 480w,https://developer.android.com/static/codelabs/android-direct-share/img/14e2b1d9aa12bbb1_720.png 720w,https://developer.android.com/static/codelabs/android-direct-share/img/14e2b1d9aa12bbb1_856.png 856w,https://developer.android.com/static/codelabs/android-direct-share/img/14e2b1d9aa12bbb1_960.png 960w,https://developer.android.com/static/codelabs/android-direct-share/img/14e2b1d9aa12bbb1_1440.png 1440w,https://developer.android.com/static/codelabs/android-direct-share/img/14e2b1d9aa12bbb1_1920.png 1920w,https://developer.android.com/static/codelabs/android-direct-share/img/14e2b1d9aa12bbb1_2880.png 2880w" sizes="(max-width: 840px) 100vw, 856px"></p>


        </google-codelab-step>
      
        <google-codelab-step label="Declaring Sharing Shortcuts" duration="6" step="3">
          
          <h2 class="step-title" id="3" data-text="Declaring Sharing Shortcuts" tabindex="-1">
              4. Declaring Sharing Shortcuts
          </h2>
          <p>Direct Share uses the  <a href="https://developer.android.com/reference/androidx/core/content/pm/ShortcutManagerCompat.html" target="_blank">ShortcutManager API</a> to publish sharing shortcuts. It&#39;s similar to the  <a href="https://developer.android.com/guide/topics/ui/shortcuts" target="_blank">App Shortcuts feature</a>.</p>
<p>Let&#39;s start working on the app and implement Direct Share. Start with the <code translate="no" dir="ltr">direct-share-start</code> sub-project.</p>
<p>There are two main steps to follow:</p>
<ol type="1">
<li>Declare share-target elements in the application&#39;s shortcuts xml resource.</li>
<li>Publish dynamic shortcuts with matching categories to the declared share-targets with the ShortcutManager API.</li>
</ol>
<h2 is-upgraded id="share-targets-declaration" data-text="Share targets declaration" tabindex="-1">Share targets declaration</h2>
<p>A share target defines the metadata of a sharing shortcut, including:</p>
<ul>
<li>Information about the shared data type</li>
<li>Categories that can be associated with the sharing shortcut</li>
<li>Activity that will handle the share Intent</li>
</ul>
<p>Share targets must be declared in the application&#39;s resource file where  <a href="https://developer.android.com/guide/topics/ui/shortcuts/creating-shortcuts" target="_blank">static shortcuts</a> are also defined. In our example, you can find it in <code translate="no" dir="ltr">app/src/main/res/xml/shortcuts.xml</code>.</p>
<p>You don&#39;t have to do anything at the moment, this file is already available in the project. You can open and see it.</p>
<h3 is-upgraded id="shortcuts.xml" data-text="shortcuts.xml" tabindex="-1"><strong>shortcuts.xml</strong></h3>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="scdoc"><code translate="no" dir="ltr">&lt;shortcuts xmlns:android="http://schemas.android.com/apk/res/android"&gt;
    &lt;share-target android:targetClass="com.example.android.directshare.SendMessageActivity"&gt;
        &lt;data android:mimeType="text/plain" /&gt;
        &lt;category android:name="com.example.android.directshare.category.TEXT_SHARE_TARGET" /&gt;
    &lt;/share-target&gt;
&lt;/shortcuts&gt;
</code></pre></devsite-code>
<p>Share target definitions are added inside the <code translate="no" dir="ltr">&lt;shortcuts&gt;</code> root element in the resource file along with other possible static shortcut definitions.</p>
<p><strong>Data element</strong> in share-target is similar to the  <a href="https://developer.android.com/guide/topics/manifest/data-element" target="_blank">data specification in an intent filter</a>.</p>
<p>Each share-target can have multiple <strong>associated categories</strong>, which will be solely used to match published shortcuts of an app with its share target definitions. Categories can be any arbitrary string. Internally, the framework will match the category of the sharing shortcut with the category given in the xml resource of the app. The <strong>target class</strong> will handle the share Intent.</p>
<p>The <code translate="no" dir="ltr">shortcuts.xml</code> file needs to be declared in an activity whose intent filters are set to the <code translate="no" dir="ltr">android.intent.action.MAIN</code> action and the <code translate="no" dir="ltr">android.intent.category.LAUNCHER</code> category in the <code translate="no" dir="ltr">AndroidManifest.xml</code> file.</p>
<h2 is-upgraded id="update-the-androidmanifest.xml-file-to-declare-share-targets" data-text="Update the AndroidManifest.xml file to declare share targets" tabindex="-1">Update the AndroidManifest.xml file to declare share targets</h2>
<p>Update the code to define share targets in the app.</p>
<ol type="1">
<li>Open the <code translate="no" dir="ltr">AndroidManifest.xml</code> file</li>
<li>Uncomment Step 4 to add a <code translate="no" dir="ltr">&lt;meta-data&gt;</code> element to the <code translate="no" dir="ltr">MainActivity</code> that references the resource file where the app&#39;s share targets are defined</li>
</ol>
<h3 is-upgraded id="androidmanifest.xml" data-text="AndroidManifest.xml" tabindex="-1"><strong>AndroidManifest.xml</strong></h3>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Transact-SQL"><code translate="no" dir="ltr">&lt;<span class="devsite-syntax-n">activity</span>
<span class="devsite-syntax-w">    </span><span class="devsite-syntax-nl">android</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-n">name</span><span class="devsite-syntax-o">=</span><span class="devsite-syntax-ss">".MainActivity"</span>
<span class="devsite-syntax-w">    </span><span class="devsite-syntax-nl">android</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-n">label</span><span class="devsite-syntax-o">=</span><span class="devsite-syntax-ss">"@string/app_name"</span>&gt;
<span class="devsite-syntax-w">    </span>&lt;<span class="devsite-syntax-n">intent</span><span class="devsite-syntax-o">-</span><span class="devsite-syntax-k">filter</span>&gt;
<span class="devsite-syntax-w">        </span>&lt;<span class="devsite-syntax-k">action</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-nl">android</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-n">name</span><span class="devsite-syntax-o">=</span><span class="devsite-syntax-ss">"android.intent.action.MAIN"</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-o">/</span>&gt;
<span class="devsite-syntax-w">        </span>&lt;<span class="devsite-syntax-n">category</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-nl">android</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-n">name</span><span class="devsite-syntax-o">=</span><span class="devsite-syntax-ss">"android.intent.category.LAUNCHER"</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-o">/</span>&gt;
<span class="devsite-syntax-w">    </span>&lt;<span class="devsite-syntax-o">/</span><span class="devsite-syntax-n">intent</span><span class="devsite-syntax-o">-</span><span class="devsite-syntax-k">filter</span>&gt;
<span class="devsite-syntax-w">    </span>&lt;<span class="devsite-syntax-err">!</span><span class="devsite-syntax-c1">-- Reference resource file where the app's shortcuts are defined --</span>&gt;
<span class="devsite-syntax-w">    </span>&lt;<span class="devsite-syntax-n">meta</span><span class="devsite-syntax-o">-</span><span class="devsite-syntax-k">data</span>
<span class="devsite-syntax-w">        </span><span class="devsite-syntax-nl">android</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-n">name</span><span class="devsite-syntax-o">=</span><span class="devsite-syntax-ss">"android.app.shortcuts"</span>
<span class="devsite-syntax-w">        </span><span class="devsite-syntax-nl">android</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-n">resource</span><span class="devsite-syntax-o">=</span><span class="devsite-syntax-ss">"@xml/shortcuts"</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-o">/</span>&gt;
&lt;<span class="devsite-syntax-o">/</span><span class="devsite-syntax-n">activity</span>&gt;
</code></pre></devsite-code>


        </google-codelab-step>
      
        <google-codelab-step label="Using the ShortcutManager API" duration="3" step="4">
          
          <h2 class="step-title" id="4" data-text="Using the ShortcutManager API" tabindex="-1">
              5. Using the ShortcutManager API
          </h2>
          <p>Once the share target elements are defined, we need to publish dynamic shortcuts that match those definitions with the  <a href="https://developer.android.com/reference/androidx/core/content/pm/ShortcutManagerCompat.html" target="_blank">ShortcutManager API</a>. The sharing shortcuts are persisted in the system until they are updated by the same application or the application is uninstalled.  You will need to manually update the list of shortcuts every time you consider it appropriate (e.g. you coud update them either when the user opens the app or the most recent conversations change in a messaging app). The API offers methods to update, remove or add shortcuts.</p>
<aside class="special"><p><strong>Note</strong>: Interactions with the ShortcutManager should happen on a background thread.</p>
<p>Since these interactions don&#39;t affect the UI the user is currently in, all operations to prepare the data and call the ShorcutManager API should not be done on the UI thread.</p>
</aside>
<p>In the codelab, we use  <a href="https://developer.android.com/reference/androidx/core/content/pm/ShortcutManagerCompat.html" target="_blank">ShortcutManagerCompat</a> available in AndroidX to publish shortcuts since it provides backwards compatibility down to Android M. Use it in your project by adding the <code translate="no" dir="ltr">androidx:core</code> dependency to your project.</p>
<p>See the dependency already added in the <code translate="no" dir="ltr">direct-share-start-app/app/build.gradle</code> or <code translate="no" dir="ltr">build.gradle (Module: direct-share-start-app)</code> file as follows:</p>
<h3 is-upgraded id="build.gradle" data-text="build.gradle" tabindex="-1"><strong>build.gradle</strong></h3>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Genshi"><code translate="no" dir="ltr">implementation<span class="devsite-syntax-w"> </span>"androidx.core:core:<span class="devsite-syntax-cp">${</span><span class="devsite-syntax-n">versions</span><span class="devsite-syntax-o">.</span><span class="devsite-syntax-n">androidxCore</span><span class="devsite-syntax-cp">}</span>"
</code></pre></devsite-code>
<aside class="warning"><p>Disclaimer: AndroidX Core v1.2.0 is currently in beta.</p>
</aside>
<aside class="warning"><p>You can use the  <a href="https://developer.android.com/reference/android/content/pm/ShortcutManager" target="_blank">ShortcutManager</a> available in the Android framework, or the  <a href="https://developer.android.com/reference/android/support/v4/content/pm/ShortcutManagerCompat" target="_blank">ShortcutManagerCompat</a> available in AndroidX.</p>
<p>Using the compatibility library in AndroidX is the preferred method since it also provides backwards compatibility on older Android versions. Currently only dynamic shortcuts are supported for publishing direct share targets.</p>
</aside>
<h2 is-upgraded id="introducing-sharingshortcutsmanager" data-text="Introducing SharingShortcutsManager" tabindex="-1">Introducing SharingShortcutsManager</h2>
<p>The class in charge of interacting with the ShortcutManager in the app is the <code translate="no" dir="ltr">SharingShortcutsManager</code>. Every time that the user opens the app (i.e. when <code translate="no" dir="ltr">MainActivity</code> gets launched), we push our sharing shortcuts.</p>
<p>You can see how we interact with it in the <code translate="no" dir="ltr">MainActivity</code> class:</p>
<h3 is-upgraded id="mainactivity.kt" data-text="MainActivity.kt" tabindex="-1"><strong>MainActivity.kt</strong></h3>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="scdoc"><code translate="no" dir="ltr">override fun onCreate(savedInstanceState: Bundle?) {
    super.onCreate(savedInstanceState)
    setContentView(R.layout.activity_main)
    ...
    sharingShortcutsManager = SharingShortcutsManager().also {
        it.pushDirectShareTargets(this)
    }
}
</code></pre></devsite-code>
<h2 is-upgraded id="create-categories-that-match-your-share-target-definition" data-text="Create categories that match your share-target definition" tabindex="-1">Create categories that match your share-target definition</h2>
<p>One of the parameters that we can configure is the list of categories associated to a shortcut. All the shortcuts that we create in this codelab are of the same type. And the type has to match with what we defined previously in the <code translate="no" dir="ltr">shortcuts.xml</code> file. In this case we defined that <code translate="no" dir="ltr">SendMessageActivity</code> was associated with category <code translate="no" dir="ltr">TEXT_SHARE_TARGET</code> in <code translate="no" dir="ltr">shortcuts.xml</code>.</p>
<p>If you open <code translate="no" dir="ltr">SharingShortcutsManager.kt</code>, you can see the category defined in a constant variable.</p>
<h3 is-upgraded id="sharingshortcutsmanager.kt" data-text="SharingShortcutsManager.kt" tabindex="-1"><strong>SharingShortcutsManager.kt</strong></h3>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Transact-SQL"><code translate="no" dir="ltr"><span class="devsite-syntax-cm">/**</span>
<span class="devsite-syntax-cm"> * Category name defined in res/xml/shortcuts.xml that accepts data of type text/plain</span>
<span class="devsite-syntax-cm"> * and will trigger [SendMessageActivity]</span>
<span class="devsite-syntax-cm"> */</span>
<span class="devsite-syntax-n">private</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-n">val</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-n">categoryTextShareTarget</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-o">=</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-ss">"com.example.android.directshare.category.TEXT_SHARE_TARGET"</span>
</code></pre></devsite-code>
<p>Go to the <code translate="no" dir="ltr">pushDirectShareTargets</code> method now and uncomment the Step 5 code that creates a set of categories that the shortcuts are associated with:</p>
<h3 is-upgraded id="sharingshortcutsmanager.kt_1" data-text="SharingShortcutsManager.kt" tabindex="-1"><strong>SharingShortcutsManager.kt</strong></h3>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="verilog"><code translate="no" dir="ltr"><span class="devsite-syntax-n">fun</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-n">pushDirectShareTargets</span><span class="devsite-syntax-p">(</span><span class="devsite-syntax-nl">context:</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-n">Context</span><span class="devsite-syntax-p">)</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-p">{</span>
<span class="devsite-syntax-w">    </span><span class="devsite-syntax-p">...</span>
<span class="devsite-syntax-w">    </span><span class="devsite-syntax-c1">// Category that our sharing shortcuts will be assigned to</span>
<span class="devsite-syntax-w">    </span><span class="devsite-syntax-n">val</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-n">contactCategories</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-o">=</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-n">setOf</span><span class="devsite-syntax-p">(</span><span class="devsite-syntax-n">categoryTextShareTarget</span><span class="devsite-syntax-p">)</span>
<span class="devsite-syntax-w">    </span><span class="devsite-syntax-p">...</span>
<span class="devsite-syntax-p">}</span>
</code></pre></devsite-code>


        </google-codelab-step>
      
        <google-codelab-step label="Anatomy of a Shortcut" duration="5" step="5">
          
          <h2 class="step-title" id="5" data-text="Anatomy of a Shortcut" tabindex="-1">
              6. Anatomy of a Shortcut
          </h2>
          <p>Let&#39;s explore what we can configure in a shortcut.</p>
<p>Uncomment the code in Step 6 that creates shortcuts and adds them to the list of shortcuts that will get published by the <code translate="no" dir="ltr">ShortcutManagerCompat</code>. We will go through the code in more detail in this section.</p>
<p>For the simplicity of the sample, we always add the same first four contacts that are defined in the <code translate="no" dir="ltr">Contact.kt</code> file. If you open it, you can see we create an array with ten contacts and methods to retrieve them.</p>
<aside class="warning"><p><strong>Shortcut limitations</strong></p>
<p>The app only publishes <strong>four</strong> shortcuts due to shortcut limitations. Never add more shortcuts than what&#39;s defined in  <a href="https://developer.android.com/reference/androidx/core/content/pm/ShortcutManagerCompat.html#getMaxShortcutCountPerActivity(android.content.Context)" target="_blank"><code translate="no" dir="ltr">ShortcutManagerCompat.getMaxShortcutCountPerActivity</code></a>. The app will crash. You can find more information about why  <a href="https://developer.android.com/guide/topics/ui/shortcuts#shortcut-limitations" target="_blank">here</a>.</p>
</aside>
<p>In the uncommented code, we create a shortcut using the <code translate="no" dir="ltr">ShortcutInfoCompat.Builder</code>. This makes use of the traditional  <a href="https://en.wikipedia.org/wiki/Builder_pattern" target="_blank">Builder pattern</a>. It takes a <code translate="no" dir="ltr">Context</code> object as a parameter which in this case is the <code translate="no" dir="ltr">Activity</code> that calls this method and a String id.</p>
<p>The <strong>id parameter</strong> is important since it will identify this shortcut when the target activity receives the sharing intent. The activity will get the id with the <strong><code translate="no" dir="ltr">EXTRA_SHORTCUT_ID</code></strong> Intent extra. In our case, the id will be the Contact Id which is represented by the position it occupies in the array.</p>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Text only"><code translate="no" dir="ltr">ShortcutInfoCompat.Builder(context, Integer.toString(id))
</code></pre></devsite-code>
<p>Next, we configure the <strong>short label</strong> and the <strong>icon</strong> that will get displayed in the system Intent chooser dialog.</p>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Text only"><code translate="no" dir="ltr">ShortcutInfoCompat.Builder(context, Integer.toString(id))
        .setShortLabel(contact.name)
        // Icon that will be displayed in the share target
        .setIcon(IconCompat.createWithResource(context, contact.icon))
</code></pre></devsite-code>
<p>You can see in the image below how setting these attributes modify the UI displayed in the system Intent dialog chooser.</p>
<p class="image-container"><img alt="2f68efb77e7a8317.png" style="width: 460.04px" src="/static/codelabs/android-direct-share/img/2f68efb77e7a8317.png" srcset="https://developer.android.com/static/codelabs/android-direct-share/img/2f68efb77e7a8317_36.png 36w,https://developer.android.com/static/codelabs/android-direct-share/img/2f68efb77e7a8317_48.png 48w,https://developer.android.com/static/codelabs/android-direct-share/img/2f68efb77e7a8317_72.png 72w,https://developer.android.com/static/codelabs/android-direct-share/img/2f68efb77e7a8317_96.png 96w,https://developer.android.com/static/codelabs/android-direct-share/img/2f68efb77e7a8317_480.png 480w,https://developer.android.com/static/codelabs/android-direct-share/img/2f68efb77e7a8317_720.png 720w,https://developer.android.com/static/codelabs/android-direct-share/img/2f68efb77e7a8317_856.png 856w,https://developer.android.com/static/codelabs/android-direct-share/img/2f68efb77e7a8317_960.png 960w,https://developer.android.com/static/codelabs/android-direct-share/img/2f68efb77e7a8317_1440.png 1440w,https://developer.android.com/static/codelabs/android-direct-share/img/2f68efb77e7a8317_1920.png 1920w,https://developer.android.com/static/codelabs/android-direct-share/img/2f68efb77e7a8317_2880.png 2880w" sizes="(max-width: 840px) 100vw, 856px"></p>
<p>The <strong>intent</strong> defined in the <code translate="no" dir="ltr">ShortcutInfoCompat</code> builder is triggered only if the shortcut is opened as a  <a href="https://developer.android.com/guide/topics/ui/shortcuts" target="_blank">static shortcut</a>. This is important to understand to avoid confusion in the future.</p>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Text only"><code translate="no" dir="ltr">ShortcutInfoCompat.Builder(context, Integer.toString(id))
        ...
        .setIntent(staticLauncherShortcutIntent)
</code></pre></devsite-code>
<p>To differentiate that Intent with the one received as a sharing shortcut in this example, we are  defining it with an <code translate="no" dir="ltr">ACTION_DEFAULT</code> action.</p>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Scilab"><code translate="no" dir="ltr"><span class="devsite-syntax-c1">// Item that will be sent if the shortcut is opened as a static launcher shortcut</span>
<span class="devsite-syntax-n">val</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-n">staticLauncherShortcutIntent</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-p">=</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-n">Intent</span><span class="devsite-syntax-p">(</span><span class="devsite-syntax-n">Intent</span><span class="devsite-syntax-p">.</span><span class="devsite-syntax-n">ACTION_DEFAULT</span><span class="devsite-syntax-p">)</span>
</code></pre></devsite-code>
<p>If a shortcut is <strong>long-lived</strong>, it can be cached by various system services and can appear as a sharing target even if it has been unpublished or removed by the app.</p>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Text only"><code translate="no" dir="ltr">ShortcutInfoCompat.Builder(context, Integer.toString(id))
        // Make this sharing shortcut cached by the system
        // Even if it is unpublished, it can still appear on the sharesheet
        .setLongLived(true)
</code></pre></devsite-code>
<p><strong>Categories</strong> will be used to filter shortcuts which can handle various share intents or actions. This field is required for shortcuts that are intended to be used as share targets. To assign the category we created before, use the following method:</p>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Text only"><code translate="no" dir="ltr">ShortcutInfoCompat.Builder(context, Integer.toString(id))
        .setCategories(contactCategories)
</code></pre></devsite-code>
<p>You can also assign <strong>people</strong> to shortcuts. This is used for better understanding of user behavior across different apps, and help potential prediction services in the Android framework to provide better suggestions in the chooser dialog. Adding Person info to a shortcut is <strong>optional</strong>, but strongly recommended. Note that not all share targets can be associated with a person (e.g. share to cloud).</p>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Text only"><code translate="no" dir="ltr">ShortcutInfoCompat.Builder(context, Integer.toString(id))
        // Person objects are used to give better suggestions
        .setPerson(
                Person.Builder()
                        .setName(contact.name)
                        .build()
        )
</code></pre></devsite-code>
<p>With all this configuration, our shortcut is ready and we can build it.</p>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Text only"><code translate="no" dir="ltr">ShortcutInfoCompat.Builder(context, Integer.toString(id))
        .build()
</code></pre></devsite-code>
<p>The code in Step 6 has created four sharing shortcuts that can already be published.</p>


        </google-codelab-step>
      
        <google-codelab-step label="Publishing sharing shortcuts" duration="8" step="6">
          
          <h2 class="step-title" id="6" data-text="Publishing sharing shortcuts" tabindex="-1">
              7. Publishing sharing shortcuts
          </h2>
          <p>Now that we have four sharing targets in the array, we can publish them using the <code translate="no" dir="ltr">ShortcutManagerCompat</code>. Uncomment Step 7 from the <code translate="no" dir="ltr">SharingShortcutsManager.kt</code> file:</p>
<h3 is-upgraded id="sharingshortcutsmanager.kt_2" data-text="SharingShortcutsManager.kt" tabindex="-1"><strong>SharingShortcutsManager.kt</strong></h3>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Text only"><code translate="no" dir="ltr">ShortcutManagerCompat.addDynamicShortcuts(context, shortcuts)
</code></pre></devsite-code>
<aside class="special"><p><strong>Note</strong>: For the simplicity of the app, we just use the <code translate="no" dir="ltr">addDynamicShortcuts</code> method. Use the  <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete" target="_blank">CRUD operations</a> available in  <a href="https://developer.android.com/reference/androidx/core/content/pm/ShortcutManagerCompat.html" target="_blank">ShortcutManagerCompat</a> for a better management of your shortcuts.</p>
</aside>
<h2 is-upgraded id="triggering-the-intent" data-text="Triggering the Intent" tabindex="-1">Triggering the Intent</h2>
<p>If the user selects one of our app&#39;s Direct Share contacts in the system Intent dialog chooser that matches the share-target that we defined above. The following intent will be triggered:</p>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="ActionScript 3"><code translate="no" dir="ltr"><span class="devsite-syntax-n">Action</span><span class="devsite-syntax-o">:</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-n">Intent</span><span class="devsite-syntax-o">.</span><span class="devsite-syntax-na">ACTION_SEND</span>
<span class="devsite-syntax-n">ComponentName</span><span class="devsite-syntax-o">:</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-o">{</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-n">com</span><span class="devsite-syntax-o">.</span><span class="devsite-syntax-na">example</span><span class="devsite-syntax-o">.</span><span class="devsite-syntax-na">android</span><span class="devsite-syntax-o">.</span><span class="devsite-syntax-na">directshare</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-o">/</span>
<span class="devsite-syntax-w">                  </span><span class="devsite-syntax-n">com</span><span class="devsite-syntax-o">.</span><span class="devsite-syntax-na">example</span><span class="devsite-syntax-o">.</span><span class="devsite-syntax-na">android</span><span class="devsite-syntax-o">.</span><span class="devsite-syntax-na">directshare</span><span class="devsite-syntax-o">.</span><span class="devsite-syntax-na">SendMessageActivity</span><span class="devsite-syntax-o">}</span>
<span class="devsite-syntax-n">Data</span><span class="devsite-syntax-o">:</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-n">Uri</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-n">to</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-n">the</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-n">shared</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-n">content</span>
<span class="devsite-syntax-n">EXTRA_SHORTCUT_ID</span><span class="devsite-syntax-o">:</span><span class="devsite-syntax-w"> </span>&lt;<span class="devsite-syntax-n">ID</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-n">of</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-n">the</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-n">selected</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-n">shortcut</span>&gt;
</code></pre></devsite-code>
<aside class="special"><p><strong>Note</strong>: The field <strong><code translate="no" dir="ltr">EXTRA_SHORTCUT_ID</code></strong> will be present in the Intent only when it comes from a Direct Share. If the user tapped on the app instead of choosing a sharing shortcut, that field won&#39;t be there.</p>
</aside>
<h2 is-upgraded id="receiving-the-intent" data-text="Receiving the Intent" tabindex="-1">Receiving the Intent</h2>
<p><code translate="no" dir="ltr">SendMessageActivity</code> will receive the Intent as it was defined in the <code translate="no" dir="ltr">shortcuts.xml</code> file. Apart from that, the activity also needs to define that is handling that type of Intents in the <code translate="no" dir="ltr">AndroidManifest.xml</code> file. That is specified in the <code translate="no" dir="ltr">&lt;intent-filter&gt;</code> tag inside the <code translate="no" dir="ltr">SendMessageActivity</code> manifest declaration as you can see in the following code:</p>
<h3 is-upgraded id="androidmanifest.xml_1" data-text="AndroidManifest.xml" tabindex="-1"><strong>AndroidManifest.xml</strong></h3>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Transact-SQL"><code translate="no" dir="ltr">&lt;<span class="devsite-syntax-n">activity</span>
<span class="devsite-syntax-w">    </span><span class="devsite-syntax-nl">android</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-n">name</span><span class="devsite-syntax-o">=</span><span class="devsite-syntax-ss">".SendMessageActivity"</span>
<span class="devsite-syntax-w">    </span><span class="devsite-syntax-nl">android</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-n">label</span><span class="devsite-syntax-o">=</span><span class="devsite-syntax-ss">"@string/app_name"</span>
<span class="devsite-syntax-w">    </span><span class="devsite-syntax-nl">android</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-n">theme</span><span class="devsite-syntax-o">=</span><span class="devsite-syntax-ss">"@style/DirectShareDialogTheme"</span>&gt;
<span class="devsite-syntax-w">    </span>&lt;<span class="devsite-syntax-err">!</span><span class="devsite-syntax-c1">-- This activity can respond to Intents of ACTION_SEND and with text/plain data --</span>&gt;
<span class="devsite-syntax-w">    </span>&lt;<span class="devsite-syntax-n">intent</span><span class="devsite-syntax-o">-</span><span class="devsite-syntax-k">filter</span>&gt;
<span class="devsite-syntax-w">        </span>&lt;<span class="devsite-syntax-k">action</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-nl">android</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-n">name</span><span class="devsite-syntax-o">=</span><span class="devsite-syntax-ss">"android.intent.action.SEND"</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-o">/</span>&gt;
<span class="devsite-syntax-w">        </span>&lt;<span class="devsite-syntax-n">category</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-nl">android</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-n">name</span><span class="devsite-syntax-o">=</span><span class="devsite-syntax-ss">"android.intent.category.DEFAULT"</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-o">/</span>&gt;
<span class="devsite-syntax-w">        </span>&lt;<span class="devsite-syntax-k">data</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-nl">android</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-n">mimeType</span><span class="devsite-syntax-o">=</span><span class="devsite-syntax-ss">"text/plain"</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-o">/</span>&gt;
<span class="devsite-syntax-w">    </span>&lt;<span class="devsite-syntax-o">/</span><span class="devsite-syntax-n">intent</span><span class="devsite-syntax-o">-</span><span class="devsite-syntax-k">filter</span>&gt;
&lt;<span class="devsite-syntax-o">/</span><span class="devsite-syntax-n">activity</span>&gt;
</code></pre></devsite-code>
<p>Open the <code translate="no" dir="ltr">SendMessageActivity.kt</code> class, let&#39;s go through the code. When it starts, it checks the information received in the Intent. If there&#39;s no information about the contact, then it launches the <code translate="no" dir="ltr">SelectContactActivity</code> to select a contact. It will receive the contact selected information in the <code translate="no" dir="ltr">onActivityResult</code> method.</p>
<h2 is-upgraded id="running-the-app" data-text="Running the App" tabindex="-1">Running the App</h2>
<p>At this point, we can run the app with Steps 1, 2 and 3 uncommented. Since we haven&#39;t made it backwards compatible with older Android versions yet, we need to run it with an Android 10 device.</p>
<aside class="special"><p>Notice that we need to run the app at least once if we want the sharing shortcuts to be available.</p>
</aside>
<h3 is-upgraded id="choosing-the-app-in-the-chooser-dialog" data-text="Choosing the app in the chooser dialog" tabindex="-1">Choosing the app in the chooser dialog</h3>
<p>As explained above, if we choose our app to receive the shared text, the user is prompted to select a contact. After selecting the contact, the user can send the shared message.</p>
<p class="image-container"><img alt="1c756facb7566057.gif" style="width: 318.05px" src="/static/codelabs/android-direct-share/img/1c756facb7566057.gif"></p>
<h3 is-upgraded id="choosing-a-direct-share-contact-in-the-chooser-dialog" data-text="Choosing a Direct Share Contact in the chooser dialog" tabindex="-1">Choosing a Direct Share Contact in the chooser dialog</h3>
<p>If we choose a Contact that was published by the Direct Share app, <code translate="no" dir="ltr">SendMessageActivity</code> can get the ID of the contact with <code translate="no" dir="ltr">Intent.EXTRA_SHORTCUT_ID</code>. Check the method <code translate="no" dir="ltr">handleIntent</code> in <code translate="no" dir="ltr">SendMessageActivity</code> to see how it is implemented.</p>
<h3 is-upgraded id="sendmessageactivity.kt" data-text="SendMessageActivity.kt" tabindex="-1"><strong>SendMessageActivity.kt</strong></h3>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="scdoc"><code translate="no" dir="ltr">val shortcutId = intent.getStringExtra(Intent.EXTRA_SHORTCUT_ID)
</code></pre></devsite-code>
<p class="image-container"><img alt="2bbc2b76794c6c75.gif" style="width: 325.96px" src="/static/codelabs/android-direct-share/img/2bbc2b76794c6c75.gif"></p>
<h3 is-upgraded id="launching-a-direct-share-launcher-shortcut" data-text="Launching a Direct Share launcher shortcut" tabindex="-1">Launching a Direct Share launcher shortcut</h3>
<p>If we open one of the sharing shortcuts we published as a launcher shortcut, the system will trigger the <code translate="no" dir="ltr">Intent.ACTION_DEFAULT</code> Intent that we defined in the <code translate="no" dir="ltr">ShortcutInfoCompat.Builder</code>.</p>
<p class="image-container"><img alt="cb975dc2d172b6a.gif" style="width: 300.50px" src="/static/codelabs/android-direct-share/img/cb975dc2d172b6a.gif"></p>


        </google-codelab-step>
      
        <google-codelab-step label="Making Direct Share backwards compatible" duration="5" step="7">
          
          <h2 class="step-title" id="7" data-text="Making Direct Share backwards compatible" tabindex="-1">
              8. Making Direct Share backwards compatible
          </h2>
          <p>Direct Share was  <a href="https://developer.android.com/about/versions/marshmallow/android-6.0#direct-share" target="_blank">first introduced</a> in Android M where you had to  <a href="https://developer.android.com/about/versions/marshmallow/android-6.0#direct-share" target="_blank">implement a service</a> extending <code translate="no" dir="ltr">ChooserTargetService</code> to provide direct share targets on demand. The way to do that changed in Android Q where we provide direct share targets in advance with the ShortcutManager API.</p>
<p>If we run the app on a device with <strong>API level 23-28,</strong> we can see that the app is listed as an option but there are no direct targets:</p>
<p class="image-container"><img alt="7ef6f7bafb63cdb.png" style="width: 283.22px" src="/static/codelabs/android-direct-share/img/7ef6f7bafb63cdb.png" srcset="https://developer.android.com/static/codelabs/android-direct-share/img/7ef6f7bafb63cdb_36.png 36w,https://developer.android.com/static/codelabs/android-direct-share/img/7ef6f7bafb63cdb_48.png 48w,https://developer.android.com/static/codelabs/android-direct-share/img/7ef6f7bafb63cdb_72.png 72w,https://developer.android.com/static/codelabs/android-direct-share/img/7ef6f7bafb63cdb_96.png 96w,https://developer.android.com/static/codelabs/android-direct-share/img/7ef6f7bafb63cdb_480.png 480w,https://developer.android.com/static/codelabs/android-direct-share/img/7ef6f7bafb63cdb_720.png 720w,https://developer.android.com/static/codelabs/android-direct-share/img/7ef6f7bafb63cdb_856.png 856w,https://developer.android.com/static/codelabs/android-direct-share/img/7ef6f7bafb63cdb_960.png 960w,https://developer.android.com/static/codelabs/android-direct-share/img/7ef6f7bafb63cdb_1440.png 1440w,https://developer.android.com/static/codelabs/android-direct-share/img/7ef6f7bafb63cdb_1920.png 1920w,https://developer.android.com/static/codelabs/android-direct-share/img/7ef6f7bafb63cdb_2880.png 2880w" sizes="(max-width: 840px) 100vw, 856px"></p>
<p>We have already mentioned backwards compatibility in previous sections when introducing the  <a href="https://developer.android.com/reference/android/support/v4/content/pm/ShortcutManagerCompat" target="_blank">ShortcutManagerCompat</a> available in AndroidX. There&#39;s still more work to be done though:</p>
<ol type="1">
<li>Open the <code translate="no" dir="ltr">direct-share-start-app/app/build.gradle</code> (or <code translate="no" dir="ltr">build.gradle (Module: direct-share-start-app)</code>file. There you can see some <code translate="no" dir="ltr">AndroidX</code> dependencies related to Direct Share. As before, the <code translate="no" dir="ltr">core</code> dependency includes ShortcutManagerCompat, and the <code translate="no" dir="ltr">sharetarget</code> dependency will implement the <code translate="no" dir="ltr">ChooserTargetServiceCompat</code> service which enables it to work on older Android versions. If you are implementing this in your project, you need these dependencies (or newer).</li>
</ol>
<h3 is-upgraded id="appbuild.gradle" data-text="app/build.gradle" tabindex="-1"><strong>app/build.gradle</strong></h3>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Carbon"><code translate="no" dir="ltr"><span class="devsite-syntax-nx">implementation</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-err">'</span><span class="devsite-syntax-nx">androidx</span><span class="devsite-syntax-p">.</span><span class="devsite-syntax-nx">core</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-nx">core</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-m devsite-syntax-m-Double">1.2.0</span><span class="devsite-syntax-o">-</span><span class="devsite-syntax-nx">beta01</span><span class="devsite-syntax-err">'</span>
<span class="devsite-syntax-nx">implementation</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-err">'</span><span class="devsite-syntax-nx">androidx</span><span class="devsite-syntax-p">.</span><span class="devsite-syntax-nx">sharetarget</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-nx">sharetarget</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-m devsite-syntax-m-Double">1.0.0</span><span class="devsite-syntax-o">-</span><span class="devsite-syntax-nx">beta01</span><span class="devsite-syntax-err">'</span>
</code></pre></devsite-code>
<ol type="1" start="2">
<li>Open the <code translate="no" dir="ltr">AndroidManifest.xml</code> file and go to the <code translate="no" dir="ltr">SendMessageActivity</code> declaration. Since it receives Intents coming from sharing shortcuts (Direct Share), it needs to provide a <code translate="no" dir="ltr">&lt;meta-data&gt;</code> tag with the name: <code translate="no" dir="ltr">android.service.chooser.chooser_target_service</code>.</li>
<li>Uncomment Step 8 to include the service for the backwards compatibility feature.</li>
</ol>
<h3 is-upgraded id="androidmanifest.xml_2" data-text="AndroidManifest.xml" tabindex="-1"><strong>AndroidManifest.xml</strong></h3>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="scdoc"><code translate="no" dir="ltr">&lt;activity
    android:name=".SendMessageActivity"&gt;
    ...
    &lt;meta-data
        android:name="android.service.chooser.chooser_target_service"
        android:value="androidx.sharetarget.ChooserTargetServiceCompat" /&gt;
&lt;/activity&gt;
</code></pre></devsite-code>
<p>Both <code translate="no" dir="ltr">android.service.chooser.chooser_target_service</code> and <code translate="no" dir="ltr">androidx.sharetarget.ChooserTargetServiceCompat</code> values are static and always the same. If in your app you handle sharing intents with multiple activities, you will have to add this <code translate="no" dir="ltr">&lt;meta-data&gt;</code> to all of them.</p>
<p>With those steps, Direct Share is now backwards compatible.</p>
<aside class="special"><p><strong>Important:</strong> The <code translate="no" dir="ltr">ChooserTargetServiceCompat</code> service is already declared in the <code translate="no" dir="ltr">sharetarget</code> compatibility library, you don&#39;t have to declare it in the app&#39;s manifest.</p>
</aside>
<h2 is-upgraded id="running-the-app_1" data-text="Running the App" tabindex="-1">Running the App</h2>
<p>If we implement the steps above then Direct Share works correctly on devices with API level 23-28:</p>
<p class="image-container"><img alt="62a9b6a5751c9802.png" style="width: 298.65px" src="/static/codelabs/android-direct-share/img/62a9b6a5751c9802.png" srcset="https://developer.android.com/static/codelabs/android-direct-share/img/62a9b6a5751c9802_36.png 36w,https://developer.android.com/static/codelabs/android-direct-share/img/62a9b6a5751c9802_48.png 48w,https://developer.android.com/static/codelabs/android-direct-share/img/62a9b6a5751c9802_72.png 72w,https://developer.android.com/static/codelabs/android-direct-share/img/62a9b6a5751c9802_96.png 96w,https://developer.android.com/static/codelabs/android-direct-share/img/62a9b6a5751c9802_480.png 480w,https://developer.android.com/static/codelabs/android-direct-share/img/62a9b6a5751c9802_720.png 720w,https://developer.android.com/static/codelabs/android-direct-share/img/62a9b6a5751c9802_856.png 856w,https://developer.android.com/static/codelabs/android-direct-share/img/62a9b6a5751c9802_960.png 960w,https://developer.android.com/static/codelabs/android-direct-share/img/62a9b6a5751c9802_1440.png 1440w,https://developer.android.com/static/codelabs/android-direct-share/img/62a9b6a5751c9802_1920.png 1920w,https://developer.android.com/static/codelabs/android-direct-share/img/62a9b6a5751c9802_2880.png 2880w" sizes="(max-width: 840px) 100vw, 856px"></p>
<p>If we run the App on an <strong>Android L device</strong>, that doesn&#39;t have Direct Share, the app will still be listed as an option.</p>
<p class="image-container"><img alt="c779d94e0ffbd6fa.png" style="width: 286.70px" src="/static/codelabs/android-direct-share/img/c779d94e0ffbd6fa.png" srcset="https://developer.android.com/static/codelabs/android-direct-share/img/c779d94e0ffbd6fa_36.png 36w,https://developer.android.com/static/codelabs/android-direct-share/img/c779d94e0ffbd6fa_48.png 48w,https://developer.android.com/static/codelabs/android-direct-share/img/c779d94e0ffbd6fa_72.png 72w,https://developer.android.com/static/codelabs/android-direct-share/img/c779d94e0ffbd6fa_96.png 96w,https://developer.android.com/static/codelabs/android-direct-share/img/c779d94e0ffbd6fa_480.png 480w,https://developer.android.com/static/codelabs/android-direct-share/img/c779d94e0ffbd6fa_720.png 720w,https://developer.android.com/static/codelabs/android-direct-share/img/c779d94e0ffbd6fa_856.png 856w,https://developer.android.com/static/codelabs/android-direct-share/img/c779d94e0ffbd6fa_960.png 960w,https://developer.android.com/static/codelabs/android-direct-share/img/c779d94e0ffbd6fa_1440.png 1440w,https://developer.android.com/static/codelabs/android-direct-share/img/c779d94e0ffbd6fa_1920.png 1920w,https://developer.android.com/static/codelabs/android-direct-share/img/c779d94e0ffbd6fa_2880.png 2880w" sizes="(max-width: 840px) 100vw, 856px"></p>


        </google-codelab-step>
      
        <google-codelab-step label="Content Preview" duration="6" step="8">
          
          <h2 class="step-title" id="8" data-text="Content Preview" tabindex="-1">
              9. Content Preview
          </h2>
          <p>When an app shares content, you can show an optional preview of it in Android Q+. The preview can have a title, image, or both.</p>
<h2 is-upgraded id="when-sharing-images" data-text="When sharing images" tabindex="-1">When sharing images</h2>
<p>When using both <code translate="no" dir="ltr">ACTION_SEND</code> and <code translate="no" dir="ltr">ACTION_SEND_MULTIPLE</code> along with URIs being shared via <code translate="no" dir="ltr">EXTRA_STREAM</code>, the system will inspect the mime type, and attempt to render image/file previews in the preview area.</p>
<p>No additional fields are needed. To get proper image preview, please also provide the contentUri in the clipData, as the <code translate="no" dir="ltr">Intent.ACTION_SEND</code>  <a href="https://developer.android.com/reference/android/content/Intent#ACTION_SEND" target="_blank">reference doc</a> specifies.</p>
<h2 is-upgraded id="when-sharing-text" data-text="When sharing text" tabindex="-1">When sharing text</h2>
<p>The previous way of adding a title to the shared content is deprecated. You need to pass the title as an Intent extra using <code translate="no" dir="ltr">Intent.EXTRA_TITLE</code>.</p>
<ol type="1">
<li>Open <code translate="no" dir="ltr">MainActivity.kt</code> and find the <code translate="no" dir="ltr">share</code> method. Uncomment Step 9.1 to add a title to the shared content.</li>
</ol>
<h3 is-upgraded id="mainactivity.kt_1" data-text="MainActivity.kt" tabindex="-1"><strong>MainActivity.kt</strong></h3>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="scdoc"><code translate="no" dir="ltr">sharingIntent.putExtra(Intent.EXTRA_TITLE, getString(R.string.send_intent_title))
</code></pre></devsite-code>
<p>If you run the app, you will see that <em>Send message</em> is the title of the shared content <em>Hello!</em>.</p>
<p class="image-container"><img alt="99404bc94b7198c9.png" style="width: 297.89px" src="/static/codelabs/android-direct-share/img/99404bc94b7198c9.png" srcset="https://developer.android.com/static/codelabs/android-direct-share/img/99404bc94b7198c9_36.png 36w,https://developer.android.com/static/codelabs/android-direct-share/img/99404bc94b7198c9_48.png 48w,https://developer.android.com/static/codelabs/android-direct-share/img/99404bc94b7198c9_72.png 72w,https://developer.android.com/static/codelabs/android-direct-share/img/99404bc94b7198c9_96.png 96w,https://developer.android.com/static/codelabs/android-direct-share/img/99404bc94b7198c9_480.png 480w,https://developer.android.com/static/codelabs/android-direct-share/img/99404bc94b7198c9_720.png 720w,https://developer.android.com/static/codelabs/android-direct-share/img/99404bc94b7198c9_856.png 856w,https://developer.android.com/static/codelabs/android-direct-share/img/99404bc94b7198c9_960.png 960w,https://developer.android.com/static/codelabs/android-direct-share/img/99404bc94b7198c9_1440.png 1440w,https://developer.android.com/static/codelabs/android-direct-share/img/99404bc94b7198c9_1920.png 1920w,https://developer.android.com/static/codelabs/android-direct-share/img/99404bc94b7198c9_2880.png 2880w" sizes="(max-width: 840px) 100vw, 856px"></p>
<p>To add a thumbnail to the title, create a content URI with the image you want to display. Set the Uri with the <code translate="no" dir="ltr">Intent.setClipData(contentUri)</code> method and set the <code translate="no" dir="ltr">Intent.FLAG_GRANT_READ_URI_PERMISSION</code> flag in the Intent.</p>
<ol type="1" start="2">
<li>In the still in the <code translate="no" dir="ltr">share()</code> method, uncomment Step 9.2 to add a thumbnail to the shared content.</li>
</ol>
<h3 is-upgraded id="mainactivity.kt_2" data-text="MainActivity.kt" tabindex="-1"><strong>MainActivity.kt</strong></h3>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="scdoc"><code translate="no" dir="ltr">val thumbnail = getClipDataThumbnail()
thumbnail?.let {
    sharingIntent.clipData = it
    sharingIntent.flags = Intent.FLAG_GRANT_READ_URI_PERMISSION
}
</code></pre></devsite-code>
<h2 is-upgraded id="create-content-uri" data-text="Create content Uri" tabindex="-1">Create content Uri</h2>
<p>Take a look at the <code translate="no" dir="ltr">getClipDataThumbnail()</code> method in <code translate="no" dir="ltr">MainActivity.kt</code>, we create the content Uri as follows:</p>
<h3 is-upgraded id="mainactivity.kt_3" data-text="MainActivity.kt" tabindex="-1"><strong>MainActivity.kt</strong></h3>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Text only"><code translate="no" dir="ltr">val contentUri = saveThumbnailImage()
ClipData.newUri(contentResolver, null, contentUri)
...
</code></pre></devsite-code>
<p><code translate="no" dir="ltr">contentUri</code> is the Uri of the launcher image that we save to cache (in the <code translate="no" dir="ltr">images</code> folder) in the <code translate="no" dir="ltr">saveThumbnailImage()</code> method. The <code translate="no" dir="ltr">contentResolver</code> needs access to the folder that we just declared. To do that:</p>
<ol type="1">
<li>Open the <code translate="no" dir="ltr">AndroidManifest.xml</code> file.</li>
<li>Inside the <code translate="no" dir="ltr">&lt;application&gt;</code> tag, uncomment Step 9.3. This will define a  <a href="https://developer.android.com/reference/androidx/core/content/FileProvider.html" target="_blank">FileProvider</a> what will be able to create and share the content Uri safely.</li>
</ol>
<h3 is-upgraded id="androidmanifest.xml_3" data-text="AndroidManifest.xml" tabindex="-1"><strong>AndroidManifest.xml</strong></h3>
<div></div><devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="GDScript"><code translate="no" dir="ltr">&lt;<span class="devsite-syntax-n">provider</span>
<span class="devsite-syntax-w">    </span><span class="devsite-syntax-n">android</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-n">name</span><span class="devsite-syntax-o">=</span><span class="devsite-syntax-s2">"androidx.core.content.FileProvider"</span>
<span class="devsite-syntax-w">    </span><span class="devsite-syntax-n">android</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-n">authorities</span><span class="devsite-syntax-o">=</span><span class="devsite-syntax-s2">"com.example.android.directshare.fileprovider"</span>
<span class="devsite-syntax-w">    </span><span class="devsite-syntax-n">android</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-n">exported</span><span class="devsite-syntax-o">=</span><span class="devsite-syntax-s2">"false"</span>
<span class="devsite-syntax-w">    </span><span class="devsite-syntax-n">android</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-n">grantUriPermissions</span><span class="devsite-syntax-o">=</span><span class="devsite-syntax-s2">"true"</span>&gt;
<span class="devsite-syntax-w">    </span>&lt;<span class="devsite-syntax-n">meta</span><span class="devsite-syntax-o">-</span><span class="devsite-syntax-n">data</span>
<span class="devsite-syntax-w">        </span><span class="devsite-syntax-n">android</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-n">name</span><span class="devsite-syntax-o">=</span><span class="devsite-syntax-s2">"android.support.FILE_PROVIDER_PATHS"</span>
<span class="devsite-syntax-w">        </span><span class="devsite-syntax-n">android</span><span class="devsite-syntax-p">:</span><span class="devsite-syntax-n">resource</span><span class="devsite-syntax-o">=</span><span class="devsite-syntax-s2">"@xml/file_paths"</span><span class="devsite-syntax-w"> </span><span class="devsite-syntax-o">/</span>&gt;
&lt;<span class="devsite-syntax-o">/</span><span class="devsite-syntax-n">provider</span>&gt;
</code></pre></devsite-code>
<aside class="special"><p><strong>Content Uri</strong></p>
<p>A content Uri allows you to grant read and write access using temporary access permissions. Read more about FileProvider and Content Uri  <a href="https://developer.android.com/training/secure-file-sharing/setup-sharing" target="_blank">here</a>.</p>
</aside>
<p>If you run the app on an Android 10 device, you can see a thumbnail image next to the title. The thumbnail will appear as long as the shared content has a title. It won&#39;t appear without the title.</p>
<p class="image-container"><img alt="df966d69090d6be3.png" style="width: 297.50px" src="/static/codelabs/android-direct-share/img/df966d69090d6be3.png" srcset="https://developer.android.com/static/codelabs/android-direct-share/img/df966d69090d6be3_36.png 36w,https://developer.android.com/static/codelabs/android-direct-share/img/df966d69090d6be3_48.png 48w,https://developer.android.com/static/codelabs/android-direct-share/img/df966d69090d6be3_72.png 72w,https://developer.android.com/static/codelabs/android-direct-share/img/df966d69090d6be3_96.png 96w,https://developer.android.com/static/codelabs/android-direct-share/img/df966d69090d6be3_480.png 480w,https://developer.android.com/static/codelabs/android-direct-share/img/df966d69090d6be3_720.png 720w,https://developer.android.com/static/codelabs/android-direct-share/img/df966d69090d6be3_856.png 856w,https://developer.android.com/static/codelabs/android-direct-share/img/df966d69090d6be3_960.png 960w,https://developer.android.com/static/codelabs/android-direct-share/img/df966d69090d6be3_1440.png 1440w,https://developer.android.com/static/codelabs/android-direct-share/img/df966d69090d6be3_1920.png 1920w,https://developer.android.com/static/codelabs/android-direct-share/img/df966d69090d6be3_2880.png 2880w" sizes="(max-width: 840px) 100vw, 856px"></p>


        </google-codelab-step>
      
        <google-codelab-step label="[Optional] Try Direct Share on your own" duration="6" step="9">
          
          <h2 class="step-title" id="9" data-text="[Optional] Try Direct Share on your own" tabindex="-1">
              10. [Optional] Try Direct Share on your own
          </h2>
          <p>There are some improvements that you can make to your code. This is an optional step that you can try on your own:</p>
<ol type="1">
<li>Modify the intent that gets triggered when the user taps on a launcher shortcut so that it opens the <code translate="no" dir="ltr">SendMessageActivity</code> with a contact already populated. Tips: The intent needs to be of type <code translate="no" dir="ltr">Intent.ACTION_SEND</code> and the contact Id needs to be sent with it.</li>
<li>Modify <code translate="no" dir="ltr">SendMessageActivity</code> to process the new Intent.</li>
</ol>


        </google-codelab-step>
      
        <google-codelab-step label="Congratulations!" duration="1" step="10">
          
          <h2 class="step-title" id="10" data-text="Congratulations!" tabindex="-1">
              11. Congratulations!
          </h2>
          <p>You&#39;re now familiar with the concepts behind Direct Share and you are ready to implement it in your apps. In this codelab you learned about:</p>
<ul>
<li>How to implement Direct Share in your app</li>
<li>How to make Direct Share backwards compatible with older Android versions</li>
<li>How to show content preview in shared content</li>
</ul>


        </google-codelab-step>
      
    </google-codelab>
  
  

  
</div>

  
    
    
    
  

  <div class="devsite-floating-action-buttons"></div></article>


<devsite-content-footer class="nocontent">
  <p>Except as otherwise noted, the content of this page is licensed under the <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 License</a>, and code samples are licensed under the <a href="https://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 License</a>. For details, see the <a href="https://developers.google.com/site-policies">Google Developers Site Policies</a>. Java is a registered trademark of Oracle and/or its affiliates.</p>
  
</devsite-content-footer>


<devsite-notification
>
</devsite-notification>


  
<div class="devsite-content-data">
  
  
    <template class="devsite-content-data-template">
      [[["Easy to understand","easyToUnderstand","thumb-up"],["Solved my problem","solvedMyProblem","thumb-up"],["Other","otherUp","thumb-up"]],[["Missing the information I need","missingTheInformationINeed","thumb-down"],["Too complicated / too many steps","tooComplicatedTooManySteps","thumb-down"],["Out of date","outOfDate","thumb-down"],["Samples / code issue","samplesCodeIssue","thumb-down"],["Other","otherDown","thumb-down"]],[],[],[],null,[]]
    </template>
  
</div>
            
          </devsite-content>
        </main>
        <devsite-footer-promos class="devsite-footer">
          
            

<nav class="devsite-footer-promos nocontent" aria-label="Promotions">
  <ul class="devsite-footer-promos-list">
    
    <li class="devsite-footer-promo">
      <a href="//x.com/AndroidDev"
         class="devsite-footer-promo-title gc-analytics-event"
         data-category="Site-Wide Custom Events"
       
       
         data-label="Footer X Promo"
       >
        
        
        <picture>
          
          <source class="devsite-dark-theme"
                  srcset="https://developer.android.com/_static/android/images/logo-x_dt.svg"
                  media="(prefers-color-scheme: dark)">
          
          <img class="devsite-footer-promo-icon"
                src="/_static/android/images/logo-x.svg"
                loading="lazy"
                alt="X">
        </picture>
        
        <span class="devsite-footer-promo-label">
          X
        </span>
      </a>
      <div class="devsite-footer-promo-description">Follow @AndroidDev on X</div>
    </li>
    
    <li class="devsite-footer-promo">
      <a href="//www.youtube.com/user/androiddevelopers"
         class="devsite-footer-promo-title gc-analytics-event"
         data-category="Site-Wide Custom Events"
       
       
         data-label="Footer YouTube Promo"
       >
        
        
        <picture>
          
          <source class="devsite-dark-theme"
                  srcset="https://developer.android.com/_static/android/images/logo-youtube_dt.svg"
                  media="(prefers-color-scheme: dark)">
          
          <img class="devsite-footer-promo-icon"
                src="//www.gstatic.com/images/icons/material/product/2x/youtube_48dp.png"
                loading="lazy"
                alt="YouTube">
        </picture>
        
        <span class="devsite-footer-promo-label">
          YouTube
        </span>
      </a>
      <div class="devsite-footer-promo-description">Check out Android Developers on YouTube</div>
    </li>
    
    <li class="devsite-footer-promo">
      <a href="//www.linkedin.com/showcase/androiddev"
         class="devsite-footer-promo-title gc-analytics-event"
         data-category="Site-Wide Custom Events"
       
       
         data-label="Footer LinkedIn Promo"
       >
        
        
        <picture>
          
          <source class="devsite-dark-theme"
                  srcset="https://developer.android.com/_static/android/images/logo-linkedin_dt.svg"
                  media="(prefers-color-scheme: dark)">
          
          <img class="devsite-footer-promo-icon"
                src="/_static/android/images/logo-linkedin.svg"
                loading="lazy"
                alt="LinkedIn">
        </picture>
        
        <span class="devsite-footer-promo-label">
          LinkedIn
        </span>
      </a>
      <div class="devsite-footer-promo-description">Connect with the Android Developers community on LinkedIn</div>
    </li>
    
  </ul>
</nav>

          
        </devsite-footer-promos>
        <devsite-footer-linkboxes class="devsite-footer">
          
            
<nav class="devsite-footer-linkboxes nocontent" aria-label="Footer links">
  
  <ul class="devsite-footer-linkboxes-list">
    
    <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading no-link">More Android</h3>
      <ul class="devsite-footer-linkbox-list">
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="//www.android.com"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 1)"
            >
            
          
            Android
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="//www.android.com/enterprise/"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 2)"
            >
            
          
            Android for Enterprise
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="//www.android.com/security-center/"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 3)"
            >
            
          
            Security
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="//source.android.com"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 4)"
            >
            
          
            Source
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/news"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 5)"
            >
            
          
            News
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="//android-developers.googleblog.com/"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 6)"
            >
            
          
            Blog
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/podcasts"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 7)"
            >
            
              
              
            
          
            Podcasts
          
          </a>
          
          
        </li>
        
      </ul>
    </li>
    
    <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading no-link">Discover</h3>
      <ul class="devsite-footer-linkbox-list">
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/games"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 1)"
            >
            
          
            Gaming
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/ml"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 2)"
            >
            
          
            Machine Learning
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/health-and-fitness"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 3)"
            >
            
          
            Health & Fitness
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/media"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 4)"
            >
            
          
            Camera & Media
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/privacy"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 5)"
            >
            
          
            Privacy
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/training/connectivity/5g"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 6)"
            >
            
              
              
            
          
            5G
          
          </a>
          
          
        </li>
        
      </ul>
    </li>
    
    <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading no-link">Android Devices</h3>
      <ul class="devsite-footer-linkbox-list">
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/large-screens"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 1)"
            >
            
          
            Large screens
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/wear"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 2)"
            >
            
          
            Wear OS
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/chrome-os"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 3)"
            >
            
          
            ChromeOS devices
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/cars"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 4)"
            >
            
          
            Android for cars
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/tv"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 5)"
            >
            
              
              
            
          
            Android TV
          
          </a>
          
          
        </li>
        
      </ul>
    </li>
    
    <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading no-link">Releases</h3>
      <ul class="devsite-footer-linkbox-list">
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/about/versions/15"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 1)"
            >
            
          
            Android 15
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/about/versions/14"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 2)"
            >
            
          
            Android 14
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/about/versions/13"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 3)"
            >
            
          
            Android 13
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/about/versions/12"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 4)"
            >
            
          
            Android 12
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/about/versions/11"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 5)"
            >
            
          
            Android 11
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/about/versions/10"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 6)"
            >
            
          
            Android 10
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/about/versions/pie"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 7)"
            >
            
              
              
            
          
            Pie
          
          </a>
          
          
        </li>
        
      </ul>
    </li>
    
    <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading no-link">Documentation and Downloads</h3>
      <ul class="devsite-footer-linkbox-list">
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/studio/intro"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 1)"
            >
            
          
            Android Studio guide
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/guide"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 2)"
            >
            
          
            Developers guides
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/reference"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 3)"
            >
            
          
            API reference
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/studio"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 4)"
            >
            
          
            Download Studio
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="/ndk"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 5)"
            >
            
              
              
            
          
            Android NDK
          
          </a>
          
          
        </li>
        
      </ul>
    </li>
    
    <li class="devsite-footer-linkbox ">
    <h3 class="devsite-footer-linkbox-heading no-link">Support</h3>
      <ul class="devsite-footer-linkbox-list">
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="//issuetracker.google.com/issues/new?component=190923&amp;template=841312"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 1)"
            >
            
          
            Report platform bug
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="//issuetracker.google.com/issues/new?component=192697"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 2)"
            >
            
          
            Report documentation bug
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="//support.google.com/googleplay/android-developer"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 3)"
            >
            
          
            Google Play support
          
          </a>
          
          
        </li>
        
        <li class="devsite-footer-linkbox-item">
          
          <a href="https://g.co/userresearch/androiddeveloperfooter"
             class="devsite-footer-linkbox-link gc-analytics-event"
             data-category="Site-Wide Custom Events"
            
             data-label="Footer Link (index 4)"
            >
            
              
              
            
          
            Join research studies
          
          </a>
          
          
        </li>
        
      </ul>
    </li>
    
  </ul>
  
</nav>
          
        </devsite-footer-linkboxes>
        <devsite-footer-utility class="devsite-footer">
          
            

<div class="devsite-footer-utility nocontent">
  
  
  <nav class="devsite-footer-sites" aria-label="Other Google Developers websites">
    <a href="https://developers.google.com/"
       class="devsite-footer-sites-logo-link gc-analytics-event"
       data-category="Site-Wide Custom Events"
       data-label="Footer Google Developers Link">
      <picture>
        
        <source srcset="https://www.gstatic.com/devrel-devsite/prod/vc12d84b6edb3e25e1619b575cf813e1849a1c95098b711a6c56ab3968c9a4fa9/android/images/lockup-google-for-developers-dark-theme.svg"
                media="(prefers-color-scheme: none)"
                class="devsite-dark-theme">
        
        <img class="devsite-footer-sites-logo"
             src="https://www.gstatic.com/devrel-devsite/prod/vc12d84b6edb3e25e1619b575cf813e1849a1c95098b711a6c56ab3968c9a4fa9/android/images/lockup-google-for-developers.svg"
             loading="lazy"
             alt="Google Developers">
      </picture>
    </a>
    <ul class="devsite-footer-sites-list">
      
      <li class="devsite-footer-sites-item">
        <a href="//developer.android.com"
           class="devsite-footer-sites-link
                  gc-analytics-event"
           data-category="Site-Wide Custom Events"
         
           data-label="Footer Android Link"
         
         >
          Android
        </a>
      </li>
      
      <li class="devsite-footer-sites-item">
        <a href="//developer.chrome.com/home"
           class="devsite-footer-sites-link
                  gc-analytics-event"
           data-category="Site-Wide Custom Events"
         
           data-label="Footer Chrome Link"
         
         >
          Chrome
        </a>
      </li>
      
      <li class="devsite-footer-sites-item">
        <a href="//firebase.google.com"
           class="devsite-footer-sites-link
                  gc-analytics-event"
           data-category="Site-Wide Custom Events"
         
           data-label="Footer Firebase Link"
         
         >
          Firebase
        </a>
      </li>
      
      <li class="devsite-footer-sites-item">
        <a href="//cloud.google.com"
           class="devsite-footer-sites-link
                  gc-analytics-event"
           data-category="Site-Wide Custom Events"
         
           data-label="Footer Google Cloud Platform Link"
         
         >
          Google Cloud Platform
        </a>
      </li>
      
      <li class="devsite-footer-sites-item">
        <a href="//developers.google.com/products/"
           class="devsite-footer-sites-link
                  gc-analytics-event"
           data-category="Site-Wide Custom Events"
         
           data-label="Footer All products Link"
         
         >
          All products
        </a>
      </li>
      
    </ul>
  </nav>
  

  
  <nav class="devsite-footer-utility-links" aria-label="Utility links">
    
    <ul class="devsite-footer-utility-list">
      
      <li class="devsite-footer-utility-item
                 ">
        
        
        <a class="devsite-footer-utility-link gc-analytics-event"
           href="//policies.google.com/privacy"
           data-category="Site-Wide Custom Events"
           data-label="Footer Privacy link"
         >
          Privacy
        </a>
        
      </li>
      
      <li class="devsite-footer-utility-item
                 ">
        
        
        <a class="devsite-footer-utility-link gc-analytics-event"
           href="/license"
           data-category="Site-Wide Custom Events"
           data-label="Footer License link"
         >
          License
        </a>
        
      </li>
      
      <li class="devsite-footer-utility-item
                 ">
        
        
        <a class="devsite-footer-utility-link gc-analytics-event"
           href="/distribute/marketing-tools/brand-guidelines"
           data-category="Site-Wide Custom Events"
           data-label="Footer Brand guidelines link"
         >
          Brand guidelines
        </a>
        
      </li>
      
      <li class="devsite-footer-utility-item
                 glue-cookie-notification-bar-control">
        
        
        <a class="devsite-footer-utility-link gc-analytics-event"
           href="#"
           data-category="Site-Wide Custom Events"
           data-label="Footer Manage cookies link"
         
           aria-hidden="true"
         >
          Manage cookies
        </a>
        
      </li>
      
      <li class="devsite-footer-utility-item
                 devsite-footer-utility-button">
        
        <span class="devsite-footer-utility-description">Get news and tips by email</span>
        
        
        <a class="devsite-footer-utility-link gc-analytics-event"
           href="/updates"
           data-category="Site-Wide Custom Events"
           data-label="Footer Subscribe link"
         >
          Subscribe
        </a>
        
      </li>
      
    </ul>
    
    
<devsite-language-selector>
  <ul role="presentation">
    
    
    <li role="presentation">
      <a role="menuitem" lang="en"
        >English</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="de"
        >Deutsch</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="es_419"
        >Español – América Latina</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="fr"
        >Français</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="id"
        >Indonesia</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="pl"
        >Polski</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="pt_br"
        >Português – Brasil</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="vi"
        >Tiếng Việt</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="zh_cn"
        >中文 – 简体</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="ja"
        >日本語</a>
    </li>
    
    <li role="presentation">
      <a role="menuitem" lang="ko"
        >한국어</a>
    </li>
    
  </ul>
</devsite-language-selector>

  </nav>
</div>
          
        </devsite-footer-utility>
        <devsite-panel>
          
        </devsite-panel>
        
      </section></section>
    <devsite-sitemask></devsite-sitemask>
    <devsite-snackbar></devsite-snackbar>
    <devsite-tooltip ></devsite-tooltip>
    <devsite-heading-link></devsite-heading-link>
    <devsite-analytics>
      
        <script type="application/json" analytics>[]</script>
<script type="application/json" tag-management>{&#34;at&#34;: &#34;True&#34;, &#34;ga4&#34;: [{&#34;id&#34;: &#34;G-QFRN08RN6E&#34;, &#34;purpose&#34;: 0}], &#34;ga4p&#34;: [{&#34;id&#34;: &#34;G-QFRN08RN6E&#34;, &#34;purpose&#34;: 0}], &#34;gtm&#34;: [], &#34;parameters&#34;: {&#34;internalUser&#34;: &#34;False&#34;, &#34;language&#34;: {&#34;machineTranslated&#34;: &#34;False&#34;, &#34;requested&#34;: &#34;en&#34;, &#34;served&#34;: &#34;en&#34;}, &#34;pageType&#34;: &#34;codelab&#34;, &#34;projectName&#34;: null, &#34;signedIn&#34;: &#34;False&#34;, &#34;tenant&#34;: &#34;android&#34;, &#34;recommendations&#34;: {&#34;sourcePage&#34;: &#34;&#34;, &#34;sourceType&#34;: 0, &#34;sourceRank&#34;: 0, &#34;sourceIdenticalDescriptions&#34;: 0, &#34;sourceTitleWords&#34;: 0, &#34;sourceDescriptionWords&#34;: 0, &#34;experiment&#34;: &#34;&#34;}, &#34;experiment&#34;: {&#34;ids&#34;: &#34;&#34;}}}</script>
      
    </devsite-analytics>
    
      <devsite-badger></devsite-badger>
    
    
    
<android-fully-clickable
    target="
        .android-case-study .devsite-landing-row-item,
        .android-editorial-and-updates-cards .devsite-card-content-wrapper,
        .android-editorial-and-updates-cards .devsite-landing-row-item,
        .android-grouped-resources .devsite-landing-row-item,
        .android-grouped-resources-contained--primary .devsite-landing-row-item,
        .android-grouped-resources-contained--secondary .devsite-landing-row-item,
        .android-grouped-resources-contained--tertiary .devsite-landing-row-item,
        .android-grouped-resources-uncontained--primary .devsite-landing-row-item,
        .android-grouped-resources-uncontained--secondary .devsite-landing-row-item,
        .android-grouped-resources-uncontained--tertiary .devsite-landing-row-item,
        .android-guide-cards .devsite-landing-row-item,
        .android-illustrated-resources-index .devsite-landing-row-item,
        .android-illustrated-resources-primary .devsite-landing-row-item,
        .android-illustrated-resources-secondary .devsite-landing-row-item,
        .android-illustrated-resources-secondary-small .devsite-landing-row-item,
        .android-illustrated-resources-tertiary .devsite-landing-row-item,
        .android-illustrated-resources-tertiary-small .devsite-landing-row-item,
        .android-promo .devsite-landing-row-item,
        .android-quick-link,
        .android-samples .devsite-card-wrapper,
        .fully-clickable"
    watch=".android-editorial-and-updates-cards, .android-samples, devsite-content"></android-fully-clickable>
    
<script nonce="oR5xNVKeK0DHr7wocw5Osb5+3F+R+e">
  
  (function(d,e,v,s,i,t,E){d['GoogleDevelopersObject']=i;
    t=e.createElement(v);t.async=1;t.src=s;E=e.getElementsByTagName(v)[0];
    E.parentNode.insertBefore(t,E);})(window, document, 'script',
    'https://www.gstatic.com/devrel-devsite/prod/vc12d84b6edb3e25e1619b575cf813e1849a1c95098b711a6c56ab3968c9a4fa9/android/js/app_loader.js', '[3,"en",null,"/js/devsite_app_module.js","https://www.gstatic.com/devrel-devsite/prod/vc12d84b6edb3e25e1619b575cf813e1849a1c95098b711a6c56ab3968c9a4fa9","https://www.gstatic.com/devrel-devsite/prod/vc12d84b6edb3e25e1619b575cf813e1849a1c95098b711a6c56ab3968c9a4fa9/android","https://android-dot-devsite-v2-prod.appspot.com",1,null,["/_pwa/android/manifest.json","https://www.gstatic.com/devrel-devsite/prod/vc12d84b6edb3e25e1619b575cf813e1849a1c95098b711a6c56ab3968c9a4fa9/images/video-placeholder.svg","https://www.gstatic.com/devrel-devsite/prod/vc12d84b6edb3e25e1619b575cf813e1849a1c95098b711a6c56ab3968c9a4fa9/android/images/favicon.svg","https://www.gstatic.com/devrel-devsite/prod/vc12d84b6edb3e25e1619b575cf813e1849a1c95098b711a6c56ab3968c9a4fa9/android/images/lockup.png","https://fonts.googleapis.com/css?family=Google+Sans:400,500,600,700|Google+Sans+Text:400,400italic,500,500italic,600,600italic,700,700italic|Roboto+Mono:400,500,700&display=swap"],1,null,[1,6,8,12,14,17,21,25,50,52,63,70,75,76,80,87,91,92,93,97,98,100,101,102,103,104,105,107,108,109,110,112,113,117,118,120,122,124,125,126,127,129,130,131,132,133,134,135,136,138,140,141,147,148,149,151,152,156,157,158,159,161,163,164,168,169,170,179,180,182,183,186,191,193,196],"AIzaSyAP-jjEJBzmIyKR4F-3XITp8yM9T1gEEI8","AIzaSyB6xiKGDR5O3Ak2okS4rLkauxGUG7XP0hg","developer.android.com","AIzaSyAQk0fBONSGUqCNznf6Krs82Ap1-NV6J4o","AIzaSyCCxcqdrZ_7QMeLCRY20bh_SXdAYqy70KY",null,null,null,["Cloud__enable_cloud_dlp_service","DevPro__enable_enterprise","Search__enable_page_map","DevPro__enable_google_payments_buyflow","Profiles__enable_public_developer_profiles","Profiles__enable_callout_notifications","Search__enable_dynamic_content_confidential_banner","DevPro__enable_nvidia_credits_card","Cloud__enable_cloud_shell_fte_user_flow","EngEduTelemetry__enable_engedu_telemetry","MiscFeatureFlags__developers_footer_image","Search__enable_suggestions_from_borg","DevPro__enable_cloud_innovators_plus","MiscFeatureFlags__enable_framebox_badge_methods","Profiles__enable_release_notes_notifications","Profiles__enable_completecodelab_endpoint","MiscFeatureFlags__enable_explicit_template_dependencies","Cloud__enable_llm_concierge_chat","Experiments__reqs_query_experiments","MiscFeatureFlags__developers_footer_dark_image","Cloud__enable_cloudx_experiment_ids","DevPro__enable_google_one_card","MiscFeatureFlags__enable_view_transitions","MiscFeatureFlags__enable_project_body_class","Profiles__enable_dashboard_curated_recommendations","Profiles__enable_purchase_prompts","Profiles__require_profile_eligibility_for_signin","Profiles__enable_page_saving","DevPro__remove_eu_tax_intake_form","MiscFeatureFlags__gdp_dashboard_reskin_enabled","Search__enable_ai_search_summaries_for_all","DevPro__enable_firebase_workspaces_card","Profiles__enable_profile_collections","CloudShell__cloud_code_overflow_menu","Profiles__enable_developer_profiles_callout","Cloud__enable_cloud_shell","Concierge__enable_remove_info_panel_tags","Analytics__enable_clearcut_logging","Cloud__enable_legacy_calculator_redirect","TpcFeatures__proxy_prod_host","Profiles__enable_stripe_subscription_management","Profiles__enable_awarding_url","Profiles__enable_recognition_badges","Search__enable_ai_eligibility_checks","DevPro__enable_developer_subscriptions","Profiles__enable_user_type","Cloud__fast_free_trial","Profiles__enable_playlist_community_acl","Profiles__enable_join_program_group_endpoint","MiscFeatureFlags__enable_project_variables","MiscFeatureFlags__enable_appearance_cookies","DevPro__enable_free_benefits","MiscFeatureFlags__enable_variable_operator","MiscFeatureFlags__enable_dark_theme","DevPro__enable_devpro_offers","Significatio__enable_by_tenant","Cloud__cache_serialized_dynamic_content","Profiles__enable_complete_playlist_endpoint","Concierge__enable_actions_menu","TpcFeatures__enable_unmirrored_page_left_nav","MiscFeatureFlags__enable_variable_operator_index_yaml","MiscFeatureFlags__enable_firebase_utm","DevPro__enable_vertex_credit_card","DevPro__enable_code_assist","MiscFeatureFlags__emergency_css","Cloud__enable_free_trial_server_call","Profiles__enable_developer_profile_benefits_ui_redesign","DevPro__enable_embed_profile_creation","Profiles__enable_completequiz_endpoint","CloudShell__cloud_shell_button","BookNav__enable_tenant_cache_key","Concierge__enable_pushui"],null,null,"AIzaSyBLEMok-5suZ67qRPzx0qUtbnLmyT_kCVE","https://developerscontentserving-pa.googleapis.com","AIzaSyCM4QpTRSqP5qI4Dvjt4OAScIN8sOUlO-k","https://developerscontentsearch-pa.googleapis.com",2,4,null,"https://developerprofiles-pa.googleapis.com",[3,"android","Android Developers","developer.android.com",null,"android-dot-devsite-v2-prod.appspot.com",null,null,[null,1,null,null,null,null,null,null,null,null,null,[1],null,null,null,null,null,null,[1],[1,null,null,[1,20],"/recommendations"],null,null,null,[1,null,1],[1,1,null,1,1]],null,[18,null,null,null,null,null,"/images/lockup.png","/images/touchicon-180.png",null,null,null,null,null,null,null,null,null,null,null,null,null,2,null,null,null,"/images/lockup-dark-theme.png",[]],[],null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,[6,1,14,15,20,22,23,28,29,37,43],null,[[null,null,1],[1,1]],[[null,null,null,null,null,null,null,[["G-QFRN08RN6E"],null,null,[["G-QFRN08RN6E",1]]],null,null,null,null,1],null,[[2,2],[1,1]]],null,4,null,null,null,null,null,null,null,null,null,null,null,null,null,"android.devsite.google"],null,"pk_live_5170syrHvgGVmSx9sBrnWtA5luvk9BwnVcvIi7HizpwauFG96WedXsuXh790rtij9AmGllqPtMLfhe2RSwD6Pn38V00uBCydV4m",1,null,"https://developerscontentinsights-pa.googleapis.com","AIzaSyCg-ZUslalsEbXMfIo9ZP8qufZgo3LSBDU","AIzaSyDxT0vkxnY_KeINtA4LSePJO-4MAZPMRsE","https://developers.googleapis.com",null,null,"AIzaSyBQom12tzI-rybN7Sf-KfeL4nwm-Rf7PmI\n",null,"https://developerslogging.googleapis.com"]')
  
</script>

    <devsite-a11y-announce></devsite-a11y-announce>
  </body>
</html>